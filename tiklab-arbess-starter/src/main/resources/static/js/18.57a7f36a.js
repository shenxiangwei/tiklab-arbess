(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{663:function(e,r,n){"use strict";n(275);var t=n(177),a=n(0),u=n.n(a),c=n(120),i="/Users/gaomengyuan/tiklab/tiklab-arbess-ui/src/common/component/breadcrumb/BreadCrumb.js";r.a=function(e){var r=e.crumbs,n=void 0===r?[]:r,a=e.children;return u.a.createElement("div",{className:"arbess-breadcrumb",__source:{fileName:i,lineNumber:16,columnNumber:9}},u.a.createElement(t.default,{__source:{fileName:i,lineNumber:17,columnNumber:13}},n.map((function(e,r){var t=e.title,a=void 0===t?null:t,l=e.click,m=n.length-1===r;return u.a.createElement(u.a.Fragment,{key:r,__source:{fileName:i,lineNumber:23,columnNumber:29}},u.a.createElement("span",{key:r,className:l?"arbess-breadcrumb-first":"",onClick:l,__source:{fileName:i,lineNumber:24,columnNumber:33}},l&&0===r&&u.a.createElement(c.default,{style:{marginRight:8},__source:{fileName:i,lineNumber:25,columnNumber:60}}),u.a.createElement("span",{className:m?"":"arbess-breadcrumb-span",__source:{fileName:i,lineNumber:26,columnNumber:37}},a)),!m&&u.a.createElement("span",{__source:{fileName:i,lineNumber:30,columnNumber:46}}," /  "))}))),u.a.createElement("div",{__source:{fileName:i,lineNumber:36,columnNumber:13}},a))}},684:function(e,r,n){"use strict";n.d(r,"d",(function(){return L})),n.d(r,"b",(function(){return H})),n.d(r,"a",(function(){return U})),n.d(r,"c",(function(){return z}));var t=n(0),a=n.n(t),u=n(761),c=n.p+"images/pip_gitee.svg",i=n.p+"images/pip_github.svg",l=n.p+"images/pip_gitlab.svg",m=n(762),s=n.p+"images/pip_ceshi.svg",o=n(763),b=n(764),N=n.p+"images/pip_liunx.svg",f=n.p+"images/pip_docker.svg",d=n(765),_=n(766),v=n.p+"images/pip_message.svg",p=n.p+"images/pip_shell.svg",g=n.p+"images/pip_post.svg",y=n.p+"images/pip_spotbugs.svg",E=n.p+"images/pip_ssh.svg",h=n.p+"images/pip_nexus.svg",k=n(767),S=n.p+"images/pip_python.svg",j=n.p+"images/pip_php.svg",I=n.p+"images/pip_net_core.svg",w=n.p+"images/pip_checkpoint.svg",O=n.p+"images/pip_host_order.svg",A=n.p+"images/pip_host_strategy.svg",T=n.p+"images/pip_gradle.svg",x=n.p+"images/pip_c_add.svg",C=n(9),D=n(649),L=function(e){switch(e){case D.n:return"通用Git";case D.o:return"Gitee";case D.p:return"GitHub";case D.q:return"GitLab";case D.E:return"自建GitLab";case D.ab:return"SVN";case D.r:return"自建GitPuk";case D.y:return"Maven单元测试";case D.bb:return"TestHubo自动化测试";case D.A:return"Maven构建";case D.B:return"Node.Js构建";case D.b:return"Docker构建";case D.g:return"Python构建";case D.c:return"Go构建";case D.f:return"PHP构建";case D.e:return".Net Core构建";case D.d:return"Gradle构建";case D.a:return"C++构建";case D.x:return"主机部署";case D.i:return"Docker部署";case D.v:return"Kubernetes部署";case D.X:return"SonarQube";case D.Z:return"Java";case D.Y:return"SourceFare";case D.lb:return"Hadess上传";case D.nb:return"SSH上传";case D.mb:return"Nexus上传";case D.k:return"Hadess下载";case D.m:return"SSH下载";case D.l:return"Nexus下载";case D.h:return"人工卡点";case D.M:return"执行脚本";case D.z:return"消息通知";case D.D:return"后置处理";case D.s:return"主机蓝绿部署";case D.t:return"主机命令";case D.u:return"主机策略";case D.j:return"Docker蓝绿部署";case D.w:return"Kubernetes蓝绿部署"}},H=function(e){var r=e.type,n=e.width,t=void 0===n?16:n,L=e.height,H=void 0===L?16:L;return a.a.createElement("img",{src:function(){switch(r){case D.n:return u.a;case D.o:return c;case D.p:return i;case D.q:case D.E:return l;case D.ab:return m.a;case D.r:return C.productImg.gitpuk;case D.y:return s;case D.bb:return C.productImg.testhubo;case D.A:return o.a;case D.B:return b.a;case D.b:return f;case D.c:return k.a;case D.g:return S;case D.f:return j;case D.e:return I;case D.x:return N;case D.i:return f;case D.v:return d.a;case D.X:return _.a;case D.Z:return y;case D.Y:return C.productImg.sourcefare;case D.lb:return C.productImg.hadess;case D.nb:return E;case D.mb:return h;case D.k:return C.productImg.hadess;case D.m:return E;case D.l:return h;case D.h:return w;case D.M:return p;case D.z:return v;case D.D:return g;case D.s:return N;case D.t:return O;case D.u:return A;case D.j:return f;case D.w:return d.a;case D.d:return T;case D.a:return x}}(),alt:"",width:t,height:H,__source:{fileName:"/Users/gaomengyuan/tiklab/tiklab-arbess-ui/src/pipeline/design/processDesign/gui/component/TaskCommon.js",lineNumber:175,columnNumber:9}})},U=function(e){switch(e){case D.n:case D.q:case D.E:case D.ab:case D.r:case D.o:case D.p:return"源码";case D.X:case D.Z:case D.Y:return"代码扫描";case D.y:case D.bb:return"测试";case D.A:case D.B:case D.b:case D.c:case D.g:case D.f:case D.e:case D.d:case D.a:return"构建";case D.x:case D.i:return"部署";case D.s:case D.t:case D.u:case D.j:case D.w:return"部署策略";case D.M:case D.lb:case D.nb:case D.mb:case D.k:case D.m:case D.l:case D.h:return"工具";default:return"阶段名称"}},z=function(e,r){return null!=e&&((""!==e||null!=r)&&e!==r)}},727:function(e,r,n){"use strict";n(409);var t=n(290),a=n(0),u=n.n(a),c="/Users/gaomengyuan/tiklab/tiklab-arbess-ui/src/common/component/drawer/Drawer.js",i=["requireRef","children"];function l(){return(l=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var t in n)({}).hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e}).apply(null,arguments)}r.a=function(e){var r=e.requireRef,n=e.children,m=function(e,r){if(null==e)return{};var n,t,a=function(e,r){if(null==e)return{};var n={};for(var t in e)if({}.hasOwnProperty.call(e,t)){if(-1!==r.indexOf(t))continue;n[t]=e[t]}return n}(e,r);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(t=0;t<u.length;t++)n=u[t],-1===r.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,i),s=Object(a.useRef)();Object(a.useEffect)((function(){return window.addEventListener("mousedown",o,!1),function(){window.removeEventListener("mousedown",o,!1)}}),[m.visible]);var o=function(e){s.current&&r&&(s.current.contains(e.target)||s.current===e.target||m.onClose())};return u.a.createElement(t.a,l({placement:"right",closable:!1,bodyStyle:{padding:0,overflow:"hidden"}},m,{__source:{fileName:c,lineNumber:34,columnNumber:9}}),u.a.createElement("div",{ref:s,__source:{fileName:c,lineNumber:40,columnNumber:13}},n))}},761:function(e,r,n){"use strict";r.a=n.p+"images/pip_git.svg"},762:function(e,r,n){"use strict";r.a=n.p+"images/pip_svn.svg"},763:function(e,r,n){"use strict";r.a=n.p+"images/maven.png"},764:function(e,r,n){"use strict";r.a=n.p+"images/pip_nodejs.svg"},765:function(e,r,n){"use strict";r.a=n.p+"images/pip_k8s.svg"},766:function(e,r,n){"use strict";r.a=n.p+"images/pip_sonar.svg"},767:function(e,r,n){"use strict";r.a=n.p+"images/pip_go.svg"},920:function(e,r,n){"use strict";n(179);var t=n(102),a=(n(407),n(288)),u=n(0),c=n.n(u),i=n(50),l=n(115),m=n(727),s=n(663),o=n(738),b=(n(606),n(603)),N=n(199),f=n(361),d=n(684),_="/Users/gaomengyuan/tiklab/tiklab-arbess-ui/src/pipeline/history/components/HistoryDetailTree.js";function v(e){return function(e){if(Array.isArray(e))return y(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||g(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var t,a,u,c,i=[],l=!0,m=!1;try{if(u=(n=n.call(e)).next,0===r){if(Object(n)!==n)return;l=!1}else for(;!(l=(t=u.call(n)).done)&&(i.push(t.value),i.length!==r);l=!0);}catch(e){m=!0,a=e}finally{try{if(!l&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(m)throw a}}return i}}(e,r)||g(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,r){if(e){if("string"==typeof e)return y(e,r);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?y(e,r):void 0}}function y(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,t=Array(r);n<r;n++)t[n]=e[n];return t}var E=function(e){var r=e.id,n=e.logData,t=e.changeAnchor,a=e.execData,i=p(Object(u.useState)([]),2),l=i[0],m=i[1],s=function(e){return l.some((function(r){return r===e}))},b=function(e,r){var n,t=function(e,r){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=g(e))||r&&e&&"number"==typeof e.length){n&&(e=n);var t=0,a=function(){};return{s:a,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var u,c=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){i=!0,u=e},f:function(){try{c||null==n.return||n.return()}finally{if(i)throw u}}}}(r);try{for(t.s();!(n=t.n()).done;){var a=n.value;if(a.id===e)return[a.id];if(a.stageInstanceList){var u=b(e,a.stageInstanceList);if(u)return[a.id].concat(v(u))}if(a.taskInstanceList){var c=b(e,a.taskInstanceList);if(c)return[a.id].concat(v(c))}}}catch(e){t.e(e)}finally{t.f()}return null};Object(u.useEffect)((function(){if(n){var e=b(n,a)||[];m(e)}}),[n]);var y=function(e){s(e.id)?m(l.filter((function(r){return r!==e.id}))):m(l.concat(e.id)),E(e)},E=function(e){t(e.id,!1)},h=function(e,n){var t=e.deployInstanceList;return c.a.createElement("div",{className:"tree-li",key:e.id,__source:{fileName:_,lineNumber:96,columnNumber:13}},c.a.createElement("div",{className:"tree-li-firsts ".concat(r===e.id?"tree-li-active":""),style:{cursor:"pointer",paddingLeft:n},onClick:function(){return E(e)},__source:{fileName:_,lineNumber:97,columnNumber:17}},c.a.createElement("div",{className:"tree-li-first",__source:{fileName:_,lineNumber:101,columnNumber:21}},c.a.createElement("div",{className:"tree-li-icon",__source:{fileName:_,lineNumber:102,columnNumber:25}},c.a.createElement(d.b,{type:e.taskType,__source:{fileName:_,lineNumber:103,columnNumber:29}})),c.a.createElement("div",{className:"tree-li-name",__source:{fileName:_,lineNumber:105,columnNumber:25}},e.taskName)),c.a.createElement("div",{className:"tree-li-state",__source:{fileName:_,lineNumber:107,columnNumber:21}},Object(o.b)(e.runState)),c.a.createElement("div",{className:"tree-li-time",__source:{fileName:_,lineNumber:108,columnNumber:21}},e.runTimeDate)),c.a.createElement("div",{className:"tree-ul",__source:{fileName:_,lineNumber:110,columnNumber:17}},t&&t.map((function(e){return function(e,n){return c.a.createElement("div",{className:"tree-li ".concat(r===e.id?"tree-li-active":""),key:e.id,onClick:function(){return E(e)},__source:{fileName:_,lineNumber:78,columnNumber:13}},c.a.createElement("div",{className:"tree-li-firsts",style:{cursor:"pointer",paddingLeft:n},__source:{fileName:_,lineNumber:81,columnNumber:17}},c.a.createElement("div",{className:"tree-li-first",__source:{fileName:_,lineNumber:82,columnNumber:21}},c.a.createElement("div",{className:"tree-li-name",__source:{fileName:_,lineNumber:83,columnNumber:25}},e.name||"--")),c.a.createElement("div",{className:"tree-li-state",__source:{fileName:_,lineNumber:85,columnNumber:21}},Object(o.b)(e.runStatus)),c.a.createElement("div",{className:"tree-li-time",__source:{fileName:_,lineNumber:86,columnNumber:21}},e.runTime)))}(e,75)}))))};return c.a.createElement("div",{className:"bottom-tree",__source:{fileName:_,lineNumber:149,columnNumber:9}},c.a.createElement("div",{className:"tree-ul",__source:{fileName:_,lineNumber:150,columnNumber:13}},a&&a.map((function(e){var n=e.stageInstanceList;return c.a.createElement("div",{className:"tree-li",key:e.id,__source:{fileName:_,lineNumber:155,columnNumber:29}},c.a.createElement("div",{className:"tree-li-firsts ".concat(r===e.id?"tree-li-active":""),style:{paddingLeft:5,fontSize:16},onClick:function(){return y(e)},__source:{fileName:_,lineNumber:156,columnNumber:33}},c.a.createElement("div",{className:"tree-li-first",__source:{fileName:_,lineNumber:160,columnNumber:37}},c.a.createElement("div",{className:"tree-li-icon",__source:{fileName:_,lineNumber:161,columnNumber:41}},s(e.id)?c.a.createElement(N.default,{style:{fontSize:"10px"},__source:{fileName:_,lineNumber:164,columnNumber:53}}):c.a.createElement(f.a,{style:{fontSize:"10px"},__source:{fileName:_,lineNumber:165,columnNumber:53}})),c.a.createElement("div",{className:"tree-li-name",__source:{fileName:_,lineNumber:168,columnNumber:41}},e.stageName)),c.a.createElement("div",{className:"tree-li-state",__source:{fileName:_,lineNumber:170,columnNumber:37}},Object(o.b)(e.stageState)),c.a.createElement("div",{className:"tree-li-time",__source:{fileName:_,lineNumber:171,columnNumber:37}},Object(o.a)(e.stageTime))),c.a.createElement("div",{className:"tree-ul ".concat(s(e.id)?"":"tree-li-hidden"),__source:{fileName:_,lineNumber:173,columnNumber:33}},n&&n.map((function(e){return function(e,n){var t=e.taskInstanceList;return c.a.createElement("div",{className:"tree-li",key:e.id,__source:{fileName:_,lineNumber:121,columnNumber:13}},c.a.createElement("div",{className:"tree-li-firsts ".concat(r===e.id?"tree-li-active":""),style:{paddingLeft:n,fontSize:15},onClick:function(){return y(e)},__source:{fileName:_,lineNumber:122,columnNumber:17}},c.a.createElement("div",{className:"tree-li-first",__source:{fileName:_,lineNumber:126,columnNumber:21}},c.a.createElement("div",{className:"tree-li-icon",__source:{fileName:_,lineNumber:127,columnNumber:25}},s(e.id)?c.a.createElement(N.default,{style:{fontSize:"10px"},__source:{fileName:_,lineNumber:130,columnNumber:37}}):c.a.createElement(f.a,{style:{fontSize:"10px"},__source:{fileName:_,lineNumber:131,columnNumber:37}})),c.a.createElement("div",{className:"tree-li-name",__source:{fileName:_,lineNumber:134,columnNumber:25}},e.stageName)),c.a.createElement("div",{className:"tree-li-state",__source:{fileName:_,lineNumber:136,columnNumber:21}},Object(o.b)(e.stageState)),c.a.createElement("div",{className:"tree-li-time",__source:{fileName:_,lineNumber:137,columnNumber:21}},Object(o.a)(e.stageTime))),c.a.createElement("div",{className:"tree-ul ".concat(s(e.id)?null:"tree-li-hidden"),__source:{fileName:_,lineNumber:139,columnNumber:17}},t&&t.map((function(e){return h(e,45)}))))}(e,25)}))))}))))},h="/Users/gaomengyuan/tiklab/tiklab-arbess-ui/src/pipeline/history/components/HistoryDetail.js";function k(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var t,a,u,c,i=[],l=!0,m=!1;try{if(u=(n=n.call(e)).next,0===r){if(Object(n)!==n)return;l=!1}else for(;!(l=(t=u.call(n)).done)&&(i.push(t.value),i.length!==r);l=!0);}catch(e){m=!0,a=e}finally{try{if(!l&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(m)throw a}}return i}}(e,r)||function(e,r){if(e){if("string"==typeof e)return S(e,r);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?S(e,r):void 0}}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,t=Array(r);n<r;n++)t[n]=e[n];return t}var j=function(e){var r=e.execData,n=e.historyItem,t=e.back,a=e.logData,l=Object(u.useRef)(null),m=n&&n.pipeline,N=k(Object(u.useState)(!0),2),f=N[0],d=N[1],_=k(Object(u.useState)(null),2),v=_[0],p=_[1];Object(u.useEffect)((function(){a&&y(a,!1)}),[a]);var g=function(){p(null),d(!0)},y=function(e,r){p(e),d(r);var n=document.getElementById(e);n&&(l.current.scrollTop=n.offsetTop-130)},S=0,j=r&&r.reduce((function(e,r){return e+r.stageTime}),0);return c.a.createElement("div",{className:"str-detail",__source:{fileName:h,lineNumber:148,columnNumber:9}},c.a.createElement(b.a,{loading:!1,active:!0,__source:{fileName:h,lineNumber:149,columnNumber:13}},c.a.createElement("div",{className:"str-detail-bread",__source:{fileName:h,lineNumber:150,columnNumber:17}},c.a.createElement(s.a,{crumbs:[{title:(null==m?void 0:m.name)+" # "+(null==n?void 0:n.findNumber)}],__source:{fileName:h,lineNumber:151,columnNumber:21}},c.a.createElement(i.a,{style:{fontSize:16},onClick:function(){g(),t()},__source:{fileName:h,lineNumber:156,columnNumber:25}})),c.a.createElement("div",{className:"bread-center",__source:{fileName:h,lineNumber:158,columnNumber:21}},c.a.createElement("div",{className:"bread-center-item",__source:{fileName:h,lineNumber:159,columnNumber:25}},c.a.createElement("span",{className:"bread-center-name",__source:{fileName:h,lineNumber:160,columnNumber:29}},"开始时间"),c.a.createElement("span",{className:"bread-center-desc",__source:{fileName:h,lineNumber:163,columnNumber:29}},null==n?void 0:n.createTime)),c.a.createElement("div",{className:"bread-center-item",__source:{fileName:h,lineNumber:167,columnNumber:25}},c.a.createElement("span",{className:"bread-center-name",__source:{fileName:h,lineNumber:168,columnNumber:29}},"运行方式"),c.a.createElement("span",{className:"bread-center-desc",__source:{fileName:h,lineNumber:171,columnNumber:29}},function(){var e,r;switch(null==n?void 0:n.runWay){case 1:return(null==n||null===(e=n.user)||void 0===e?void 0:e.nickname)+" · 手动触发";case 2:return"定时触发";case 3:return(null==n||null===(r=n.user)||void 0===r?void 0:r.nickname)+" · 回滚触发";case 4:return"WebHook触发"}}())),c.a.createElement("div",{className:"bread-center-item",__source:{fileName:h,lineNumber:175,columnNumber:25}},c.a.createElement("span",{className:"bread-center-name",__source:{fileName:h,lineNumber:176,columnNumber:29}},"运行状态"),c.a.createElement("span",{className:"bread-center-desc bread-center-".concat(null==n?void 0:n.runStatus),__source:{fileName:h,lineNumber:179,columnNumber:29}},Object(o.c)(null==n?void 0:n.runStatus))),c.a.createElement("div",{className:"bread-center-item",__source:{fileName:h,lineNumber:183,columnNumber:25}},c.a.createElement("span",{className:"bread-center-name",__source:{fileName:h,lineNumber:184,columnNumber:29}},"运行时长"),c.a.createElement("span",{className:"bread-center-desc",__source:{fileName:h,lineNumber:187,columnNumber:29}},Object(o.a)(j))))),c.a.createElement("div",{className:"str-detail-bottom",__source:{fileName:h,lineNumber:193,columnNumber:17}},c.a.createElement(E,{id:v,logData:a,execData:r,changeAnchor:y,__source:{fileName:h,lineNumber:194,columnNumber:21}}),c.a.createElement("div",{className:"str-detail-log",ref:l,onWheel:function(){f&&d(!1)},onMouseDown:function(e){if(0===e.button){if(!f)return;S=l.current.scrollTop}},onMouseUp:function(e){if(0===e.button){if(!f)return;var r=l.current.scrollTop;S!==r&&d(!1)}},__source:{fileName:h,lineNumber:200,columnNumber:21}},(l.current&&f&&(l.current.scrollTop=l.current.scrollHeight),c.a.createElement("div",{className:"bottom-log",__source:{fileName:h,lineNumber:104,columnNumber:13}},r&&r.map((function(e){var r=e.stageInstanceList;return c.a.createElement("div",{key:e.id,id:e.id,className:"bottom-log-item",__source:{fileName:h,lineNumber:108,columnNumber:32}},r&&r.map((function(e){var r=e.taskInstanceList;return c.a.createElement("div",{key:e.id,id:e.id,__source:{fileName:h,lineNumber:112,columnNumber:44}},r&&r.map((function(e){return c.a.createElement("div",{key:e.id,id:e.id,__source:{fileName:h,lineNumber:115,columnNumber:56}},e.runLog)})))})))}))))))))},I=n(737),w=n(649),O=n(9),A="/Users/gaomengyuan/tiklab/tiklab-arbess-ui/src/pipeline/history/components/HistoryRunDetail.js";function T(e){return function(e){if(Array.isArray(e))return D(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||C(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var t,a,u,c,i=[],l=!0,m=!1;try{if(u=(n=n.call(e)).next,0===r){if(Object(n)!==n)return;l=!1}else for(;!(l=(t=u.call(n)).done)&&(i.push(t.value),i.length!==r);l=!0);}catch(e){m=!0,a=e}finally{try{if(!l&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(m)throw a}}return i}}(e,r)||C(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e,r){if(e){if("string"==typeof e)return D(e,r);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?D(e,r):void 0}}function D(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,t=Array(r);n<r;n++)t[n]=e[n];return t}r.a=function(e){var r=e.historyItem,n=e.setHistoryItem,b=e.historyType,N=e.back,f=I.a.findOneInstance,d=I.a.findStageInstance,_=I.a.keepOn,v=I.a.execStop,p=Object(u.useRef)(null),g=(null==r?void 0:r.runStatus)===w.H,y=r&&r.pipeline,E=x(Object(u.useState)([]),2),h=E[0],k=E[1],S=x(Object(u.useState)(!1),2),C=S[0],D=S[1],L=x(Object(u.useState)(null),2),H=L[0],U=L[1],z=x(Object(u.useState)(!0),2),M=z[0],G=z[1];Object(u.useEffect)((function(){return null!=r&&r.instanceId&&P("init"),function(){J()}}),[null==r?void 0:r.instanceId]);var P=function(e){d(r.instanceId).then((function(r){0===r.code?(k((null==r?void 0:r.data)||[]),g&&"init"===e?q():g&&"end"===e&&R()):clearInterval(p.current)})).finally((function(){return G(!1)}))},R=function(){f(r.instanceId).then((function(e){0===e.code&&n(e.data)}))},q=function(){p.current=setInterval((function(){d(r.instanceId).then((function(e){if(0===e.code){k((null==e?void 0:e.data)||[]);var r=T(e.data),n=(null==r?void 0:r.map((function(e){return e.stageState})))||[];if(null!=n&&n.length){var t=[w.F,w.G,w.K].some((function(e){return n.includes(e)})),a=n.at(-1)===w.I;(t||a)&&(clearInterval(p.current),setTimeout((function(){return P("end")}),1e3))}}else clearInterval(p.current)}))}),1e3)},B=function(e,r){G(!0),_({pipelineId:y.id,taskInstanceId:e.id,status:r,userId:Object(O.getUser)().userId}).finally((function(){setTimeout((function(){G(!1)}),1500)}))},W=function(){J(),N()},J=function(){G(!0),clearInterval(p.current)},F=h&&h.reduce((function(e,r){return e+r.stageTime}),0);return c.a.createElement("div",{className:"str-run-detail",__source:{fileName:A,lineNumber:180,columnNumber:9}},c.a.createElement("div",{className:"str-run-detail-bread",__source:{fileName:A,lineNumber:181,columnNumber:13}},c.a.createElement(s.a,{crumbs:[{title:"".concat(null==y?void 0:y.name," # ").concat(null==r?void 0:r.findNumber),click:"drawer"!==b?function(){return W()}:void 0}],__source:{fileName:A,lineNumber:182,columnNumber:17}},"drawer"===b&&c.a.createElement(i.a,{style:{fontSize:16},onClick:W,__source:{fileName:A,lineNumber:190,columnNumber:48}})),c.a.createElement("div",{className:"bread-center-box",__source:{fileName:A,lineNumber:192,columnNumber:17}},c.a.createElement("div",{className:"bread-center",__source:{fileName:A,lineNumber:193,columnNumber:21}},c.a.createElement("div",{className:"bread-center-item",__source:{fileName:A,lineNumber:194,columnNumber:25}},c.a.createElement("span",{className:"bread-center-name",__source:{fileName:A,lineNumber:195,columnNumber:29}},"开始时间"),c.a.createElement("span",{className:"bread-center-desc",__source:{fileName:A,lineNumber:198,columnNumber:29}},null==r?void 0:r.createTime)),c.a.createElement("div",{className:"bread-center-item",__source:{fileName:A,lineNumber:202,columnNumber:25}},c.a.createElement("span",{className:"bread-center-name",__source:{fileName:A,lineNumber:203,columnNumber:29}},"运行方式"),c.a.createElement("span",{className:"bread-center-desc",__source:{fileName:A,lineNumber:206,columnNumber:29}},function(){var e,n;switch(null==r?void 0:r.runWay){case 1:return(null==r||null===(e=r.user)||void 0===e?void 0:e.nickname)+" · 手动触发";case 2:return"定时触发";case 3:return(null==r||null===(n=r.user)||void 0===n?void 0:n.nickname)+" · 回滚触发";case 4:return"WebHook触发"}}())),c.a.createElement("div",{className:"bread-center-item",__source:{fileName:A,lineNumber:210,columnNumber:25}},c.a.createElement("span",{className:"bread-center-name",__source:{fileName:A,lineNumber:211,columnNumber:29}},"运行状态"),c.a.createElement("span",{className:"bread-center-desc run-status-".concat(null==r?void 0:r.runStatus),__source:{fileName:A,lineNumber:214,columnNumber:29}},Object(o.c)(null==r?void 0:r.runStatus))),c.a.createElement("div",{className:"bread-center-item",__source:{fileName:A,lineNumber:218,columnNumber:25}},c.a.createElement("span",{className:"bread-center-name",__source:{fileName:A,lineNumber:219,columnNumber:29}},"运行时长"),c.a.createElement("span",{className:"bread-center-desc",__source:{fileName:A,lineNumber:222,columnNumber:29}},Object(o.a)(F)))),"run"===(null==r?void 0:r.runStatus)&&c.a.createElement(l.a,{onClick:function(){G(!0),clearInterval(p.current),v(y.id).then((function(e){setTimeout((function(){return P("end")}),3e3)}))},__source:{fileName:A,lineNumber:227,columnNumber:58}},"终止"))),c.a.createElement("div",{className:"str-run-detail-center",__source:{fileName:A,lineNumber:230,columnNumber:13}},c.a.createElement(t.default,{spinning:M,__source:{fileName:A,lineNumber:231,columnNumber:17}},c.a.createElement("div",{className:"str-run-detail-box",__source:{fileName:A,lineNumber:232,columnNumber:21}},h&&h.map((function(e,r){var n=e.stageName,t=e.stageInstanceList;return c.a.createElement("div",{key:e.id,className:"str-run-item",__source:{fileName:A,lineNumber:237,columnNumber:37}},c.a.createElement("div",{className:"str-run-item-head",__source:{fileName:A,lineNumber:238,columnNumber:41}},n),c.a.createElement("div",{className:"str-run-item-stage",__source:{fileName:A,lineNumber:241,columnNumber:41}},t&&t.map((function(e,r){var n=e.taskInstanceList;return c.a.createElement("div",{key:e.id,className:"str-run-stage",__source:{fileName:A,lineNumber:246,columnNumber:57}},n&&n.map((function(e,r){var n=e.taskName,t=e.runTime,u=e.runState;return c.a.createElement("div",{className:"str-run-stage-card str-run-stage-card-".concat(u),key:e.id,__source:{fileName:A,lineNumber:251,columnNumber:73}},c.a.createElement("div",{className:"card-header",__source:{fileName:A,lineNumber:252,columnNumber:77}},c.a.createElement("div",{className:"card-state-icon",__source:{fileName:A,lineNumber:253,columnNumber:81}},Object(o.b)(u)),c.a.createElement("div",{className:"card-title",__source:{fileName:A,lineNumber:256,columnNumber:81}},n)),c.a.createElement("div",{className:"card-body run-status-".concat(u),__source:{fileName:A,lineNumber:260,columnNumber:77}},Object(o.c)(u)),c.a.createElement("div",{className:"card-footer",__source:{fileName:A,lineNumber:263,columnNumber:77}},c.a.createElement("div",{className:"card-time",__source:{fileName:A,lineNumber:264,columnNumber:81}},Object(o.a)(t)),c.a.createElement("div",{className:"card-log",onClick:function(){return function(e){U(e.id),D(!0)}(e)},__source:{fileName:A,lineNumber:267,columnNumber:81}},"日志")),"suspend"===u&&c.a.createElement("div",{className:"card-actions",__source:{fileName:A,lineNumber:273,columnNumber:81}},c.a.createElement("div",{className:"card-action card-action-continue",onClick:function(){return B(e,1)},__source:{fileName:A,lineNumber:274,columnNumber:85}},"继续执行"),c.a.createElement(a.a,{type:"vertical",__source:{fileName:A,lineNumber:280,columnNumber:85}}),c.a.createElement("div",{className:"card-action card-action-stop",onClick:function(){return B(e,2)},__source:{fileName:A,lineNumber:281,columnNumber:85}},"终止执行")))})))}))))}))))),c.a.createElement(m.a,{width:"80%",visible:C,onClose:function(){return D(!1)},__source:{fileName:A,lineNumber:305,columnNumber:13}},c.a.createElement(j,{back:function(){return D(!1)},historyItem:r,execData:h,logData:H,__source:{fileName:A,lineNumber:310,columnNumber:17}})))}}}]);