(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{1402:function(e,n,t){"use strict";t.r(n);t(521);var r=t(523),a=(t(522),t(524)),i=(t(173),t(97)),u=(t(261),t(171)),l=(t(264),t(124)),o=(t(260),t(150)),c=(t(262),t(72)),m=t(0),s=t.n(m),f=t(9),b=(t(172),t(71)),p=(t(520),t(519)),d=(t(396),t(278)),N=t.n(d),y=(t(151),t(47)),v=(t(170),t(56)),_=t(346),g=t(50),h=t(347),E=t(182),O=t(184),w=t(201),j=t(330),S=t(44),P=t(697),k=t(177),I=t(174),A=t(154),x=t(271),C=t(596),T=t(268),L=t(579),z=t(950),D=t(951),F=t(600),U=t(952),R=t(663),V=t(989),M=t(937),G="/Users/gaomengyuan/tiklab/tiklab-arbess-ui/src/pipeline/pipeline/components/PipelineTable.js";function B(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,a,i,u,l=[],o=!0,c=!1;try{if(i=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;o=!1}else for(;!(o=(r=i.call(t)).done)&&(l.push(r.value),l.length!==n);o=!0);}catch(e){c=!0,a=e}finally{try{if(!o&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(c)throw a}}return l}}(e,n)||function(e,n){if(e){if("string"==typeof e)return H(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?H(e,n):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function H(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}var $=Object(S.inject)("systemRoleStore")(Object(S.observer)((function(e){var n=e.pipelineData,t=e.changPage,r=e.changFresh,a=e.setIsLoading,o=e.systemRoleStore,d=k.a.updateFollow,S=k.a.findPipelineCloneName,H=k.a.pipelineClone,$=k.a.importPipelineYaml,J=k.a.findUserPipeline,K=P.a.execStart,Y=P.a.execStop,q=o.getInitProjectPermissions,W=B(c.default.useForm(),1)[0],Z=Object(m.useRef)(null),Q=Object(f.getUser)().userId,X=B(Object(m.useState)([]),2),ee=X[0],ne=X[1],te=B(Object(m.useState)(null),2),re=te[0],ae=te[1],ie=B(Object(m.useState)(!1),2),ue=ie[0],le=ie[1],oe=B(Object(m.useState)(!1),2),ce=oe[0],me=oe[1],se=B(Object(m.useState)(!1),2),fe=se[0],be=se[1],pe=B(Object(m.useState)(!1),2),de=pe[0],Ne=pe[1],ye=B(Object(m.useState)(null),2),ve=ye[0],_e=ye[1],ge=B(Object(m.useState)(null),2),he=ge[0],Ee=ge[1];Object(m.useEffect)((function(){he&&q(Q,ve.id,1===(null==ve?void 0:ve.power))}),[he]),Object(m.useEffect)((function(){ue&&J().then((function(e){0===e.code&&ne(e.data||[])}))}),[ue]);var Oe=function(e,n){0===e.code?(v.default.success("".concat(n,"成功")),r()):v.default.error(e.msg)},we=Object(L.c)((function(e){a(!0),1===e.state?K({pipelineId:e.id}).then((function(n){if(a(!1),0===n.code)return Pe({id:e.id,instanceId:n.data.instanceId})})):Y(e.id).then((function(e){a(!1),0===e.code&&r()}))}),1e3),je=function(){ce||(W.resetFields(),le(!1),ae(null))},Se=function(){Z.current&&Z.current.onRest(),Ne(!1),_e(null)},Pe=function(n){e.history.push("/pipeline/".concat(n.id,"/history/").concat(n.instanceId))},ke=[{title:"流水线名称",dataIndex:"name",key:"name",width:"33%",ellipsis:!0,render:function(n,t){return s.a.createElement("span",{className:"pipelineTable-name",onClick:function(){return function(n,t){e.history.push("/pipeline/".concat(t.id,"/history"))}(0,t)},__source:{fileName:G,lineNumber:273,columnNumber:25}},s.a.createElement(x.a,{text:n,colors:t.color,__source:{fileName:G,lineNumber:274,columnNumber:29}}),s.a.createElement("span",{__source:{fileName:G,lineNumber:275,columnNumber:29}},n))}},{title:"最近构建信息",dataIndex:"lastBuildTime",key:"lastBuildTime",width:"33%",ellipsis:!0,render:function(e,n){var t=n.buildStatus,r=n.number;return s.a.createElement("span",{__source:{fileName:G,lineNumber:288,columnNumber:21}},e||"无构建",r&&s.a.createElement("span",{className:"pipeline-number",onClick:function(){return Pe(n)},__source:{fileName:G,lineNumber:291,columnNumber:29}},"# ",r,s.a.createElement("span",{className:"pipeline-number-desc",__source:{fileName:G,lineNumber:292,columnNumber:33}},Object(R.b)(t))))}},{title:"负责人",dataIndex:["user","nickname"],key:"user",width:"20%",ellipsis:!0,render:function(e,n){return s.a.createElement(u.default,{__source:{fileName:G,lineNumber:307,columnNumber:21}},s.a.createElement(A.a,{userInfo:n.user,__source:{fileName:G,lineNumber:308,columnNumber:25}}),e||"--")}},{title:"操作",dataIndex:"action",key:"action",width:"14%",ellipsis:!0,render:function(n,t){var r=t.state,a=t.collect,o=t.exec;return s.a.createElement(u.default,{size:"middle",__source:{fileName:G,lineNumber:323,columnNumber:21}},s.a.createElement(y.default,{title:"收藏",__source:{fileName:G,lineNumber:324,columnNumber:25}},s.a.createElement("span",{className:"pipelineTable-action",onClick:function(){return function(e){d({id:e.id}).then((function(n){0===e.collect?Oe(n,"收藏"):Oe(n,"取消")}))}(t)},__source:{fileName:G,lineNumber:325,columnNumber:29}},s.a.createElement("img",{src:0===a?D.a:z.a,alt:"收藏",width:20,height:20,__source:{fileName:G,lineNumber:326,columnNumber:33}}))),o?s.a.createElement(y.default,{title:3===r?"等待":"运行",__source:{fileName:G,lineNumber:331,columnNumber:33}},s.a.createElement("span",{className:"pipelineTable-action",onClick:function(){return we(t)},__source:{fileName:G,lineNumber:332,columnNumber:37}},1===r&&s.a.createElement(_.a,{className:"actions-se",__source:{fileName:G,lineNumber:333,columnNumber:58}}),2===r&&s.a.createElement(i.a,{indicator:s.a.createElement(g.a,{className:"actions-se",spin:!0,__source:{fileName:G,lineNumber:334,columnNumber:75}}),__source:{fileName:G,lineNumber:334,columnNumber:58}}),3===r&&s.a.createElement(h.a,{className:"actions-se",__source:{fileName:G,lineNumber:335,columnNumber:58}}))):s.a.createElement(y.default,{title:"当前没有运行权限，请联系管理员分配",__source:{fileName:G,lineNumber:339,columnNumber:33}},s.a.createElement("span",{className:"pipelineTable-action-ban",__source:{fileName:G,lineNumber:340,columnNumber:37}},s.a.createElement(_.a,{className:"actions-se",__source:{fileName:G,lineNumber:341,columnNumber:41}}))),s.a.createElement(l.default,{overlay:s.a.createElement("div",{className:"arbess-dropdown-more",__source:{fileName:G,lineNumber:348,columnNumber:33}},s.a.createElement(N.a,{code:"pipeline_update",domainId:t.id,__source:{fileName:G,lineNumber:349,columnNumber:37}},s.a.createElement("div",{className:"dropdown-more-item",onClick:function(){return Ee(null),void Ne(!0)},__source:{fileName:G,lineNumber:350,columnNumber:41}},s.a.createElement(E.default,{__source:{fileName:G,lineNumber:351,columnNumber:45}})," 编辑")),s.a.createElement(N.a,{code:"pipeline_delete",domainId:t.id,__source:{fileName:G,lineNumber:354,columnNumber:37}},s.a.createElement("div",{className:"dropdown-more-item",onClick:function(){return Ee(null),void be(!0)},__source:{fileName:G,lineNumber:355,columnNumber:41}},s.a.createElement(O.default,{__source:{fileName:G,lineNumber:356,columnNumber:45}})," 删除")),s.a.createElement(N.a,{code:"pipeline_seting",domainId:t.id,__source:{fileName:G,lineNumber:359,columnNumber:37}},s.a.createElement("div",{className:"dropdown-more-setting",__source:{fileName:G,lineNumber:360,columnNumber:41}},s.a.createElement("div",{className:"dropdown-more-item dropdown-more-item-setting",onClick:function(){return function(n){Ee(null),e.history.push("/pipeline/".concat(n.id,"/setting/info"))}(t)},__source:{fileName:G,lineNumber:361,columnNumber:45}},s.a.createElement("img",{src:U.a,width:16,height:16,__source:{fileName:G,lineNumber:362,columnNumber:49}})," 设置"))),s.a.createElement("div",{className:"dropdown-more-item",onClick:function(){return function(e){Ee(null),S(e.id).then((function(n){ae({id:e.id,name:n.data||e.name}),W.setFieldsValue({name:n.data||e.name}),le(!0)}))}(t)},__source:{fileName:G,lineNumber:366,columnNumber:37}},s.a.createElement(w.a,{__source:{fileName:G,lineNumber:367,columnNumber:41}})," 克隆"),s.a.createElement("div",{className:"dropdown-more-item",onClick:function(){return function(e){Ee(null),$(e.id).then((function(n){if(n.code)v.default.error(n.msg);else{var t=window.URL.createObjectURL(new Blob([n],{type:"text/plain;charset=utf-8;content-type"})),r=document.createElement("a");r.href=t,r.setAttribute("download","".concat(e.name,".yaml")),document.body.appendChild(r),r.click(),r.remove(),window.URL.revokeObjectURL(t)}}))}(t)},__source:{fileName:G,lineNumber:369,columnNumber:37}},s.a.createElement(j.a,{__source:{fileName:G,lineNumber:370,columnNumber:41}})," 导出")),trigger:["click"],placement:"bottomRight",visible:he===t.id,onVisibleChange:function(e){e&&_e(t),Ee(e?t.id:null)},__source:{fileName:G,lineNumber:346,columnNumber:25}},s.a.createElement(y.default,{title:"更多",__source:{fileName:G,lineNumber:384,columnNumber:29}},s.a.createElement("span",{className:"pipelineTable-action",__source:{fileName:G,lineNumber:385,columnNumber:33}},s.a.createElement("img",{src:F.a,width:18,alt:"更多",__source:{fileName:G,lineNumber:386,columnNumber:37}})))))}}];return s.a.createElement("div",{className:"pipelineTable",__source:{fileName:G,lineNumber:406,columnNumber:9}},s.a.createElement(p.default,{columns:ke,dataSource:(null==n?void 0:n.dataList)||[],rowKey:function(e){return e.id},pagination:!1,locale:{emptyText:s.a.createElement(I.a,{__source:{fileName:G,lineNumber:412,columnNumber:37}})},__source:{fileName:G,lineNumber:407,columnNumber:13}}),s.a.createElement(C.a,{currentPage:n.currentPage,changPage:t,page:n,__source:{fileName:G,lineNumber:414,columnNumber:13}}),s.a.createElement(V.a,{pipeline:ve,delVisible:fe,setDelVisible:be,changPage:t,page:n,__source:{fileName:G,lineNumber:419,columnNumber:13}}),s.a.createElement(T.a,{title:"编辑流水线",visible:de,onCancel:Se,onOk:function(){Z.current&&Z.current.onOk()},className:"pipeline-edit",__source:{fileName:G,lineNumber:426,columnNumber:13}},s.a.createElement(M.a,{set:!0,ref:Z,pipeline:ve,onClick:Se,changFresh:r,__source:{fileName:G,lineNumber:433,columnNumber:17}})),s.a.createElement(T.a,{title:"复制流水线",visible:ue,onOk:function(){W.validateFields().then((function(e){ce||(me(!0),H({pipelineId:re.id,pipelineName:e.name}).then((function(e){0===e.code?(v.default.success("克隆成功"),je(),r()):v.default.error("克隆失败"),me(!1)})))}))},onCancel:je,width:500,__source:{fileName:G,lineNumber:441,columnNumber:13}},s.a.createElement(i.a,{spinning:ce,tip:"克隆中……",__source:{fileName:G,lineNumber:448,columnNumber:17}},s.a.createElement("div",{className:"pipelineTable-clone-modal-form",__source:{fileName:G,lineNumber:449,columnNumber:21}},s.a.createElement(c.default,{form:W,layout:"vertical",__source:{fileName:G,lineNumber:450,columnNumber:25}},s.a.createElement(c.default.Item,{name:"name",label:"名称",rules:[{required:!0,message:"名称不能为空"},{pattern:/^[\u4e00-\u9fa5a-zA-Z0-9_-]{0,30}$/,message:"流水线名称最长30位且不能包含非法字符，如&,%，&，#……等"},function(e){e.getFieldValue;return{validator:function(e,n){var t=[];return ee&&(t=ee&&ee.map((function(e){return e.name}))),t.includes(n)?Promise.reject("名称已经存在"):Promise.resolve()}}}],__source:{fileName:G,lineNumber:451,columnNumber:29}},s.a.createElement(b.default,{__source:{fileName:G,lineNumber:474,columnNumber:33}})))))))}))),J=t(594),K=t(152),Y=t(906),q=t(270),W=t(755),Z=t(861),Q=(t(560),t(557)),X=t(351),ee="/Users/gaomengyuan/tiklab/tiklab-arbess-ui/src/pipeline/pipeline/components/PipelineAddMould.js",ne=function(e){var n=e.templateType,t=e.setTemplateType,r=function(e){return s.a.createElement("div",{className:"li-step",__source:{fileName:ee,lineNumber:76,columnNumber:13}},s.a.createElement("span",{className:"li-step-name",__source:{fileName:ee,lineNumber:77,columnNumber:17}},e))};return s.a.createElement("div",{className:"pipeline-template-ul",__source:{fileName:ee,lineNumber:83,columnNumber:9}},s.a.createElement("div",{className:"pipeline-template-title",__source:{fileName:ee,lineNumber:84,columnNumber:13}},"流水线模板"),s.a.createElement("div",{className:"".concat(1===n?"pipeline-template-li pipeline-template-select":"pipeline-template-li"),onClick:function(){return t(1)},__source:{fileName:ee,lineNumber:85,columnNumber:13}},s.a.createElement("div",{className:"li-self",__source:{fileName:ee,lineNumber:88,columnNumber:17}},"自定义")),[{id:2,title:"Java",brand:"Maven",desc:"Linux",first:"Maven构建",second:"部署",type:2131},{id:4,title:"Java",brand:"Maven",desc:"Linux",zreo:"测试",first:"构建",second:"部署",type:112131},{id:6,title:"Node.js",brand:"npm",desc:"Linux",first:"构建",second:"部署",type:2231}].map((function(e){return s.a.createElement("div",{key:e.id,className:"".concat(n===e.type?"pipeline-template-li pipeline-template-select":"pipeline-template-li"),onClick:function(){return t(e.type)},__source:{fileName:ee,lineNumber:93,columnNumber:25}},s.a.createElement("div",{__source:{fileName:ee,lineNumber:97,columnNumber:29}},s.a.createElement("div",{className:"pipeline-template-li-header",__source:{fileName:ee,lineNumber:98,columnNumber:33}},s.a.createElement("span",{className:"li-header-icon",__source:{fileName:ee,lineNumber:99,columnNumber:37}},s.a.createElement(X.a,{__source:{fileName:ee,lineNumber:99,columnNumber:70}})),s.a.createElement("span",{className:"li-header-name",__source:{fileName:ee,lineNumber:100,columnNumber:37}},e.title,"-",e.brand),s.a.createElement("span",{__source:{fileName:ee,lineNumber:101,columnNumber:37}},"部署到"),s.a.createElement("span",{className:"li-header-title",__source:{fileName:ee,lineNumber:102,columnNumber:37}},e.desc),s.a.createElement("span",{__source:{fileName:ee,lineNumber:103,columnNumber:37}},"环境")),s.a.createElement("div",{className:"pipeline-template-li-content",__source:{fileName:ee,lineNumber:105,columnNumber:33}},e.zreo&&r(e.zreo),r(e.first),r(e.second))))})))};function te(e){return(te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var re="/Users/gaomengyuan/tiklab/tiklab-arbess-ui/src/pipeline/pipeline/components/PipelineAdd.js",ae=["userList"];function ie(){return(ie=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)({}).hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e}).apply(null,arguments)}function ue(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function le(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?ue(Object(t),!0).forEach((function(n){oe(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ue(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function oe(e,n,t){return(n=function(e){var n=function(e,n){if("object"!=te(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n||"default");if("object"!=te(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==te(n)?n:n+""}(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function ce(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,a,i,u,l=[],o=!0,c=!1;try{if(i=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;o=!1}else for(;!(o=(r=i.call(t)).done)&&(l.push(r.value),l.length!==n);o=!0);}catch(e){c=!0,a=e}finally{try{if(!o&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(c)throw a}}return l}}(e,n)||function(e,n){if(e){if("string"==typeof e)return me(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?me(e,n):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function me(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}var se=function(e){var n=e.visible,t=e.setVisible,r=k.a.createPipeline,a=Object(f.getUser)(),u=Object(m.useRef)(null),l=ce(Object(m.useState)(!1),2),o=l[0],c=l[1],b=ce(Object(m.useState)(0),2),p=b[0],d=b[1],N=ce(Object(m.useState)(1),2),y=N[0],v=N[1],_=ce(Object(m.useState)({power:1,type:2,group:{id:"default"},env:{id:"default"},userList:[le(le({},a),{},{id:a.userId,roleType:2})]}),2),g=_[0],h=_[1],E=function(){u.current&&u.current.onRest(),t(!1),d(0)},O=s.a.createElement("div",{className:"pipeline-template",__source:{fileName:re,lineNumber:82,columnNumber:12}},s.a.createElement("div",{className:"template-base",__source:{fileName:re,lineNumber:83,columnNumber:16}},s.a.createElement("span",{__source:{fileName:re,lineNumber:84,columnNumber:20}},"流水线名称："),s.a.createElement("span",{__source:{fileName:re,lineNumber:85,columnNumber:20}},g.name)),s.a.createElement("div",{className:"template-base",__source:{fileName:re,lineNumber:87,columnNumber:16}},s.a.createElement("span",{__source:{fileName:re,lineNumber:88,columnNumber:20}},"流水线权限："),s.a.createElement("span",{__source:{fileName:re,lineNumber:89,columnNumber:20}},1===g.power?"全局":"私有")),s.a.createElement(ne,{templateType:y,setTemplateType:v,__source:{fileName:re,lineNumber:91,columnNumber:16}})),w=[{title:"完善信息",content:s.a.createElement(M.a,ie({},e,{set:!1,ref:u,setCurrent:d,baseInfo:g,setBaseInfo:h,__source:{fileName:re,lineNumber:100,columnNumber:9}}))},{title:"选择模板",content:O}];return s.a.createElement(T.a,{className:"pipeline-add",title:"添加流水线",visible:n,width:600,onCancel:E,destroyOnClose:!0,footer:0===p?s.a.createElement(s.a.Fragment,null,s.a.createElement(K.a,{onClick:E,title:"取消",isMar:!0,__source:{fileName:re,lineNumber:132,columnNumber:25}}),s.a.createElement(K.a,{type:"primary",title:"下一步",onClick:function(){u.current&&u.current.onOk()},__source:{fileName:re,lineNumber:133,columnNumber:25}})):s.a.createElement(s.a.Fragment,null,s.a.createElement(K.a,{onClick:E,title:"取消",isMar:!0,__source:{fileName:re,lineNumber:137,columnNumber:25}}),s.a.createElement(K.a,{onClick:function(){return d(0)},title:"上一步",isMar:!0,__source:{fileName:re,lineNumber:138,columnNumber:25}}),s.a.createElement(K.a,{type:"primary",onClick:function(){var n=g.userList,t=le(le({},function(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==n.indexOf(r))continue;t[r]=e[r]}return t}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)t=i[r],-1===n.indexOf(t)&&{}.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}(g,ae)),{},{template:y,userList:n&&n.map((function(e){return{userId:e.id,roleType:e.roleType}}))});c(!0),r(t).then((function(n){0===n.code&&e.history.push("/pipeline/".concat(n.data,"/config"))})).finally((function(){return c(!1)}))},title:"确定",__source:{fileName:re,lineNumber:139,columnNumber:25}})),__source:{fileName:re,lineNumber:122,columnNumber:9}},s.a.createElement(i.a,{spinning:o,__source:{fileName:re,lineNumber:143,columnNumber:13}},s.a.createElement("div",{className:"steps-top",__source:{fileName:re,lineNumber:144,columnNumber:17}},s.a.createElement(Q.a,{current:p,__source:{fileName:re,lineNumber:145,columnNumber:21}},w.map((function(e){return s.a.createElement(Q.a.Step,{key:e.title,title:e.title,__source:{fileName:re,lineNumber:147,columnNumber:29}})})))),s.a.createElement("div",{className:"steps-content",__source:{fileName:re,lineNumber:151,columnNumber:17}},w[p].content)))},fe=t.p+"images/pip_screen.svg";function be(e){return(be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var pe="/Users/gaomengyuan/tiklab/tiklab-arbess-ui/src/pipeline/pipeline/components/Pipeline.js";function de(){return(de=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)({}).hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e}).apply(null,arguments)}function Ne(e){return function(e){if(Array.isArray(e))return Ee(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||he(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ye(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function ve(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?ye(Object(t),!0).forEach((function(n){_e(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ye(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function _e(e,n,t){return(n=function(e){var n=function(e,n){if("object"!=be(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n||"default");if("object"!=be(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==be(n)?n:n+""}(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function ge(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,a,i,u,l=[],o=!0,c=!1;try{if(i=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;o=!1}else for(;!(o=(r=i.call(t)).done)&&(l.push(r.value),l.length!==n);o=!0);}catch(e){c=!0,a=e}finally{try{if(!o&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(c)throw a}}return l}}(e,n)||he(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function he(e,n){if(e){if("string"==typeof e)return Ee(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Ee(e,n):void 0}}function Ee(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}n.default=function(e){var n=k.a.findUserPipelinePage,t=k.a.findPipelineCount,b=k.a.findUserPage,p=W.a.findEnvList,d=Z.a.findGroupList,N={pageSize:15,currentPage:1},y=ge(Object(m.useState)("all"),2),v=y[0],_=y[1],g=ge(Object(m.useState)(!1),2),h=g[0],E=g[1],O=ge(Object(m.useState)(!1),2),w=O[0],j=O[1],S=ge(Object(m.useState)({pageParam:N}),2),P=S[0],I=S[1],A=ge(Object(m.useState)({}),2),x=A[0],C=A[1],T=ge(Object(m.useState)([]),2),z=T[0],D=T[1],F=ge(Object(m.useState)([]),2),U=F[0],R=F[1],V=ge(Object(m.useState)(!1),2),M=V[0],G=V[1],B=ge(Object(m.useState)({}),2),H=B[0],Q=B[1],X=ge(Object(m.useState)(!1),2),ee=X[0],ne=X[1];Object(m.useEffect)((function(){te()}),[]);var te=function(){p().then((function(e){0===e.code&&D(e.data||[])})),d().then((function(e){0===e.code&&R(e.data||[])}))};Object(m.useEffect)((function(){re(),t(P).then((function(e){0===e.code&&Q(e.data)}))}),[P,h]);var re=function(){j(!0);var e=ve({},P);"create"===v&&(e.createUserId=Object(f.getUser)().userId),"follow"===v&&(e.pipelineFollow=1),n(e).then((function(e){0===e.code&&C(e.data)})).finally((function(){return j(!1)}))},ae=Object(L.c)((function(e){I(ve(ve({},P),{},{pipelineName:e.target.value,pageParam:N}))}),500),ie=ge(c.default.useForm(),1)[0],ue=ge(Object(m.useState)([]),2),le=ue[0],oe=ue[1],ce=ge(Object(m.useState)(1),2),me=ce[0],be=ce[1],ye=ge(Object(m.useState)({}),2),_e=ye[0],he=ye[1];Object(m.useEffect)((function(){Ee()}),[me]);var Ee=function(){b({pageParam:{pageSize:9,currentPage:me}}).then((function(e){0===e.code&&(he(e.data),oe(1===me?e.data.dataList:[].concat(Ne(le),Ne(e.data.dataList))))}))};return s.a.createElement(r.default,{className:"pipeline",__source:{fileName:pe,lineNumber:241,columnNumber:9}},s.a.createElement(a.default,{xs:{span:"24"},sm:{span:"24"},md:{span:"24"},lg:{span:"24"},xl:{span:"20",offset:"2"},xxl:{span:"18",offset:"3"},__source:{fileName:pe,lineNumber:242,columnNumber:13}},s.a.createElement("div",{className:"arbess-home-limited",__source:{fileName:pe,lineNumber:250,columnNumber:17}},s.a.createElement(J.a,{crumbs:[{title:"流水线"}],__source:{fileName:pe,lineNumber:251,columnNumber:21}},s.a.createElement(K.a,{onClick:function(){G(!0)},type:"primary",title:"新建流水线",__source:{fileName:pe,lineNumber:256,columnNumber:25}})),s.a.createElement(se,de({},e,{visible:M,setVisible:G,__source:{fileName:pe,lineNumber:258,columnNumber:21}})),s.a.createElement("div",{className:"pipeline-flex",__source:{fileName:pe,lineNumber:263,columnNumber:21}},s.a.createElement(Y.a,{type:v,tabLis:[{id:"all",title:s.a.createElement(s.a.Fragment,null,"所有",s.a.createElement("span",{className:"count-number",__source:{fileName:pe,lineNumber:265,columnNumber:50}},(null==H?void 0:H.pipelineNumber)||0))},{id:"create",title:s.a.createElement(s.a.Fragment,null,"我创建的",s.a.createElement("span",{className:"count-number",__source:{fileName:pe,lineNumber:266,columnNumber:55}},(null==H?void 0:H.userPipelineNumber)||0))},{id:"follow",title:s.a.createElement(s.a.Fragment,null,"我收藏的",s.a.createElement("span",{className:"count-number",__source:{fileName:pe,lineNumber:267,columnNumber:55}},(null==H?void 0:H.userFollowNumber)||0))}],onClick:function(e){I(ve(ve({},P),{},{pageParam:N})),_(e.id)},__source:{fileName:pe,lineNumber:264,columnNumber:25}}),s.a.createElement(u.default,{__source:{fileName:pe,lineNumber:269,columnNumber:25}},s.a.createElement(q.a,{placeholder:"搜索名称",onPressEnter:ae,style:{width:180},__source:{fileName:pe,lineNumber:270,columnNumber:29}}),s.a.createElement(l.default,{overlay:s.a.createElement("div",{className:"pipeline-senior-screen-drop",__source:{fileName:pe,lineNumber:277,columnNumber:37}},s.a.createElement(c.default,{form:ie,layout:"vertical",onValuesChange:function(e){var n=ve(ve(ve({},P),e),{},{pageParam:N});Object.keys(e).forEach((function(t){"all"===e[t]&&delete n[t]})),I(n)},__source:{fileName:pe,lineNumber:278,columnNumber:41}},s.a.createElement(c.default.Item,{label:"创建人",name:"createUserId",__source:{fileName:pe,lineNumber:283,columnNumber:45}},s.a.createElement(o.default,{placeholder:"创建人",onPopupScroll:function(e){e.persist();var n=e.target;n.scrollTop+n.offsetHeight===n.scrollHeight&&me<_e.totalPage&&be(me+1)},__source:{fileName:pe,lineNumber:284,columnNumber:49}},s.a.createElement(o.default.Option,{value:"all",key:"all",__source:{fileName:pe,lineNumber:285,columnNumber:53}},"全部"),le&&le.map((function(e){return s.a.createElement(o.default.Option,{key:e.id,value:e.id,__source:{fileName:pe,lineNumber:288,columnNumber:61}},e.nickname)})))),s.a.createElement(c.default.Item,{label:"应用",name:"groupId",__source:{fileName:pe,lineNumber:293,columnNumber:45}},s.a.createElement(o.default,{placeholder:"应用",__source:{fileName:pe,lineNumber:294,columnNumber:49}},s.a.createElement(o.default.Option,{value:"all",key:"all",__source:{fileName:pe,lineNumber:295,columnNumber:53}},"全部"),U&&U.map((function(e){return s.a.createElement(o.default.Option,{value:e.id,key:e.id,__source:{fileName:pe,lineNumber:298,columnNumber:61}},e.groupName)})))),s.a.createElement(c.default.Item,{label:"环境",name:"envId",__source:{fileName:pe,lineNumber:303,columnNumber:45}},s.a.createElement(o.default,{placeholder:"环境",__source:{fileName:pe,lineNumber:304,columnNumber:49}},s.a.createElement(o.default.Option,{value:"all",key:"all",__source:{fileName:pe,lineNumber:305,columnNumber:53}},"全部"),z&&z.map((function(e){return s.a.createElement(o.default.Option,{value:e.id,key:e.id,__source:{fileName:pe,lineNumber:308,columnNumber:61}},e.envName)})))),s.a.createElement(c.default.Item,{label:"权限",name:"pipelinePower",__source:{fileName:pe,lineNumber:313,columnNumber:45}},s.a.createElement(o.default,{placeholder:"权限",__source:{fileName:pe,lineNumber:314,columnNumber:49}},s.a.createElement(o.default.Option,{value:"all",key:"all",__source:{fileName:pe,lineNumber:315,columnNumber:53}},"全部"),s.a.createElement(o.default.Option,{value:1,key:1,__source:{fileName:pe,lineNumber:316,columnNumber:53}},"全局"),s.a.createElement(o.default.Option,{value:2,key:2,__source:{fileName:pe,lineNumber:317,columnNumber:53}},"私有")))),s.a.createElement("div",{className:"screen-drop-button",__source:{fileName:pe,lineNumber:321,columnNumber:41}},s.a.createElement(K.a,{isMar:!0,onClick:function(){ie.resetFields(),I({pageParam:N})},__source:{fileName:pe,lineNumber:322,columnNumber:45}},"重置"),s.a.createElement(K.a,{isMar:!0,onClick:function(){return ne(!1)},__source:{fileName:pe,lineNumber:325,columnNumber:45}},"取消"),s.a.createElement(K.a,{type:"primary",onClick:function(){return ne(!1)},__source:{fileName:pe,lineNumber:328,columnNumber:45}},"确定"))),trigger:["click"],visible:ee,onVisibleChange:function(e){return ne(e)},getPopupContainer:function(e){return e.parentElement},__source:{fileName:pe,lineNumber:275,columnNumber:29}},s.a.createElement("div",{className:"pipeline-senior-screen",__source:{fileName:pe,lineNumber:339,columnNumber:33}},s.a.createElement("img",{src:fe,width:22,height:22,__source:{fileName:pe,lineNumber:340,columnNumber:37}}))))),s.a.createElement(i.a,{spinning:w,__source:{fileName:pe,lineNumber:345,columnNumber:21}},s.a.createElement($,de({},e,{listType:v,setIsLoading:j,changPage:function(e){I(ve(ve({},P),{},{pageParam:{pageSize:15,currentPage:e}}))},changFresh:function(){E(!h)},pipelineData:x,__source:{fileName:pe,lineNumber:346,columnNumber:25}}))))))}},577:function(e,n,t){"use strict";t.d(n,"j",(function(){return r})),t.d(n,"k",(function(){return a})),t.d(n,"l",(function(){return i})),t.d(n,"m",(function(){return u})),t.d(n,"x",(function(){return l})),t.d(n,"T",(function(){return o})),t.d(n,"n",(function(){return c})),t.d(n,"q",(function(){return m})),t.d(n,"U",(function(){return s})),t.d(n,"s",(function(){return f})),t.d(n,"t",(function(){return b})),t.d(n,"a",(function(){return p})),t.d(n,"b",(function(){return d})),t.d(n,"e",(function(){return N})),t.d(n,"d",(function(){return y})),t.d(n,"c",(function(){return v})),t.d(n,"p",(function(){return _})),t.d(n,"f",(function(){return g})),t.d(n,"o",(function(){return h})),t.d(n,"Q",(function(){return E})),t.d(n,"S",(function(){return O})),t.d(n,"R",(function(){return w})),t.d(n,"eb",(function(){return j})),t.d(n,"gb",(function(){return S})),t.d(n,"fb",(function(){return P})),t.d(n,"g",(function(){return k})),t.d(n,"i",(function(){return I})),t.d(n,"h",(function(){return A})),t.d(n,"F",(function(){return x})),t.d(n,"r",(function(){return C})),t.d(n,"w",(function(){return T})),t.d(n,"G",(function(){return L})),t.d(n,"H",(function(){return z})),t.d(n,"I",(function(){return D})),t.d(n,"M",(function(){return F})),t.d(n,"J",(function(){return U})),t.d(n,"P",(function(){return R})),t.d(n,"N",(function(){return V})),t.d(n,"L",(function(){return M})),t.d(n,"K",(function(){return G})),t.d(n,"O",(function(){return B})),t.d(n,"X",(function(){return H})),t.d(n,"V",(function(){return $})),t.d(n,"db",(function(){return J})),t.d(n,"Z",(function(){return K})),t.d(n,"ab",(function(){return Y})),t.d(n,"W",(function(){return q})),t.d(n,"Y",(function(){return W})),t.d(n,"bb",(function(){return Z})),t.d(n,"cb",(function(){return Q})),t.d(n,"v",(function(){return X})),t.d(n,"u",(function(){return ee})),t.d(n,"y",(function(){return ne})),t.d(n,"B",(function(){return te})),t.d(n,"z",(function(){return re})),t.d(n,"A",(function(){return ae})),t.d(n,"E",(function(){return ie})),t.d(n,"C",(function(){return ue})),t.d(n,"D",(function(){return le}));var r="git",a="gitee",i="github",u="gitlab",l="pri_gitlab",o="svn",c="gitpuk",m="maventest",s="testhubo",f="maven",b="nodejs",p="build_docker",d="build_go",N="build_python",y="build_php",v="build_net_core",_="liunx",g="docker",h="k8s",E="sonar",O="spotbugs",w="sourcefare",j="upload_hadess",S="upload_ssh",P="upload_nexus",k="download_hadess",I="download_ssh",A="download_nexus",x="script",C="message",T="post",L="gitee",z="github",D="gitlab",F="pri_gitlab",U="gitpuk",R="testhubo",V="sonar",M="nexus",G="hadess",B="sourcefare",H="jdk",$="git",J="svn",K="maven",Y="nodejs",q="go",W="k8s",Z="sonar-scanner",Q="sourcefare-scanner",X="pipeline_task_update",ee="pipeline_task_run",ne="error",te="success",re="halt",ae="run",ie="wait",ue="suspend",le="timeout"},596:function(e,n,t){"use strict";var r=t(0),a=t.n(r),i=t(115),u=t(91),l=t(294),o="/Users/gaomengyuan/tiklab/tiklab-arbess-ui/src/common/component/page/Page.js";n.a=function(e){var n=e.currentPage,t=e.changPage,r=e.page,c=r.totalPage,m=void 0===c?1:c,s=r.totalRecord,f=void 0===s?1:s;return m>1&&a.a.createElement("div",{className:"arbess-page",__source:{fileName:o,lineNumber:17,columnNumber:9}},a.a.createElement("div",{className:"arbess-page-record",__source:{fileName:o,lineNumber:18,columnNumber:13}},"  共",f,"条 "),a.a.createElement("div",{className:"".concat(1===n?"arbess-page-ban":"arbess-page-allow"),onClick:function(){return 1===n?null:t(n-1)},__source:{fileName:o,lineNumber:19,columnNumber:13}},a.a.createElement(i.default,{__source:{fileName:o,lineNumber:21,columnNumber:14}})),a.a.createElement("div",{className:"arbess-page-current",__source:{fileName:o,lineNumber:22,columnNumber:13}},n),a.a.createElement("div",{className:"arbess-page-line",__source:{fileName:o,lineNumber:23,columnNumber:13}}," / "),a.a.createElement("div",{__source:{fileName:o,lineNumber:24,columnNumber:13}},m),a.a.createElement("div",{className:"".concat(n===m?"arbess-page-ban":"arbess-page-allow"),onClick:function(){return n===m?null:t(n+1)},__source:{fileName:o,lineNumber:25,columnNumber:13}},a.a.createElement(u.default,{__source:{fileName:o,lineNumber:27,columnNumber:14}})),a.a.createElement("div",{className:"arbess-page-fresh",onClick:function(){return t(1)},__source:{fileName:o,lineNumber:28,columnNumber:13}},a.a.createElement(l.default,{__source:{fileName:o,lineNumber:29,columnNumber:17}})))}},600:function(e,n,t){"use strict";n.a=t.p+"images/pie_more.svg"},663:function(e,n,t){"use strict";t.d(n,"c",(function(){return d})),t.d(n,"b",(function(){return N})),t.d(n,"a",(function(){return y}));t(173);var r=t(97),a=t(0),i=t.n(a),u=t(132),l=t(130),o=t(117),c=t(50),m=t(346),s=t(347),f=t(348),b=t(577),p="/Users/gaomengyuan/tiklab/tiklab-arbess-ui/src/pipeline/history/components/HistoryCommon.js",d=function(e){switch(e){case b.y:return"运行失败";case b.B:return"运行成功";case b.z:return"运行终止";case b.A:return"运行中";case b.E:return"等待中";case b.C:return"暂停中";case b.D:return"运行超时"}},N=function(e){switch(e){case b.y:return i.a.createElement(u.a,{style:{color:"red"},__source:{fileName:p,lineNumber:45,columnNumber:20}});case b.B:return i.a.createElement(l.a,{style:{color:"var(--tiklab-blue)"},__source:{fileName:p,lineNumber:47,columnNumber:20}});case b.z:return i.a.createElement(o.a,{style:{color:"black"},__source:{fileName:p,lineNumber:49,columnNumber:20}});case b.A:return i.a.createElement(r.a,{indicator:i.a.createElement(c.a,{spin:!0,style:{color:"black"},__source:{fileName:p,lineNumber:51,columnNumber:37}}),__source:{fileName:p,lineNumber:51,columnNumber:20}});case b.E:return i.a.createElement(m.a,{style:{color:"black"},__source:{fileName:p,lineNumber:53,columnNumber:20}});case b.C:return i.a.createElement(s.a,{style:{color:"black"},__source:{fileName:p,lineNumber:55,columnNumber:20}});case b.D:return i.a.createElement(f.a,{style:{color:"orange",fontSize:16},__source:{fileName:p,lineNumber:57,columnNumber:20}})}},y=function(e){var n=parseInt(e/86400),t=parseInt(e%86400/3600),r=parseInt(e%3600/60),a=parseInt(e%60);return n>=1?n+" 天 "+t+" 时 "+r+" 分 "+a+" 秒":t>=1?t+" 时 "+r+" 分 "+a+" 秒":r>=1?r+" 分 "+a+" 秒":a+" 秒"}},697:function(e,n,t){"use strict";t(170);var r,a,i,u,l,o,c,m,s,f,b,p,d,N,y,v,_,g=t(56),h=t(12),E=t(9);function O(e){return(O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function w(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,n,t="function"==typeof Symbol?Symbol:{},r=t.iterator||"@@iterator",a=t.toStringTag||"@@toStringTag";function i(t,r,a,i){var o=r&&r.prototype instanceof l?r:l,c=Object.create(o.prototype);return j(c,"_invoke",function(t,r,a){var i,l,o,c=0,m=a||[],s=!1,f={p:0,n:0,v:e,a:b,f:b.bind(e,4),d:function(n,t){return i=n,l=0,o=e,f.n=t,u}};function b(t,r){for(l=t,o=r,n=0;!s&&c&&!a&&n<m.length;n++){var a,i=m[n],b=f.p,p=i[2];t>3?(a=p===r)&&(o=i[(l=i[4])?5:(l=3,3)],i[4]=i[5]=e):i[0]<=b&&((a=t<2&&b<i[1])?(l=0,f.v=r,f.n=i[1]):b<p&&(a=t<3||i[0]>r||r>p)&&(i[4]=t,i[5]=r,f.n=p,l=0))}if(a||t>1)return u;throw s=!0,r}return function(a,m,p){if(c>1)throw TypeError("Generator is already running");for(s&&1===m&&b(m,p),l=m,o=p;(n=l<2?e:o)||!s;){i||(l?l<3?(l>1&&(f.n=-1),b(l,o)):f.n=o:f.v=o);try{if(c=2,i){if(l||(a="next"),n=i[a]){if(!(n=n.call(i,o)))throw TypeError("iterator result is not an object");if(!n.done)return n;o=n.value,l<2&&(l=0)}else 1===l&&(n=i.return)&&n.call(i),l<2&&(o=TypeError("The iterator does not provide a '"+a+"' method"),l=1);i=e}else if((n=(s=f.n<0)?o:t.call(r,f))!==u)break}catch(n){i=e,l=1,o=n}finally{c=1}}return{value:n,done:s}}}(t,a,i),!0),c}var u={};function l(){}function o(){}function c(){}n=Object.getPrototypeOf;var m=[][r]?n(n([][r]())):(j(n={},r,(function(){return this})),n),s=c.prototype=l.prototype=Object.create(m);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,j(e,a,"GeneratorFunction")),e.prototype=Object.create(s),e}return o.prototype=c,j(s,"constructor",c),j(c,"constructor",o),o.displayName="GeneratorFunction",j(c,a,"GeneratorFunction"),j(s),j(s,a,"Generator"),j(s,r,(function(){return this})),j(s,"toString",(function(){return"[object Generator]"})),(w=function(){return{w:i,m:f}})()}function j(e,n,t,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}(j=function(e,n,t,r){if(n)a?a(e,n,{value:t,enumerable:!r,configurable:!r,writable:!r}):e[n]=t;else{var i=function(n,t){j(e,n,(function(e){return this._invoke(n,t,e)}))};i("next",0),i("throw",1),i("return",2)}})(e,n,t,r)}function S(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function P(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?S(Object(t),!0).forEach((function(n){T(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):S(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function k(e,n,t,r,a,i,u){try{var l=e[i](u),o=l.value}catch(e){return void t(e)}l.done?n(o):Promise.resolve(o).then(r,a)}function I(e){return function(){var n=this,t=arguments;return new Promise((function(r,a){var i=e.apply(n,t);function u(e){k(i,r,a,u,l,"next",e)}function l(e){k(i,r,a,u,l,"throw",e)}u(void 0)}))}}function A(e,n,t,r){t&&Object.defineProperty(e,n,{enumerable:t.enumerable,configurable:t.configurable,writable:t.writable,value:t.initializer?t.initializer.call(r):void 0})}function x(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,L(r.key),r)}}function C(e,n,t){return n&&x(e.prototype,n),t&&x(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function T(e,n,t){return(n=L(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function L(e){var n=function(e,n){if("object"!=O(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n||"default");if("object"!=O(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==O(n)?n:n+""}function z(e,n,t,r,a){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=t.slice().reverse().reduce((function(t,r){return r(e,n,t)||t}),i),a&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(a):void 0,i.initializer=void 0),void 0===i.initializer?(Object.defineProperty(e,n,i),null):i}var D=new(a=z((r=C((function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),A(this,"historyList",a,this),A(this,"page",i,this),A(this,"setHistoryList",u,this),A(this,"rollBackStart",l,this),A(this,"execStart",o,this),A(this,"execStop",c,this),A(this,"keepOn",m,this),A(this,"findTaskInstance",s,this),A(this,"findStageInstance",f,this),A(this,"deleteInstance",b,this),A(this,"findUserInstance",p,this),A(this,"findPipelineInstance",d,this),A(this,"findHistoryList",N,this),A(this,"findOneInstance",y,this),A(this,"findAllInstanceLogs",v,this),A(this,"findAllStageInstanceLogs",_,this)}))).prototype,"historyList",[h.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),i=z(r.prototype,"page",[h.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{currentPage:1,totalRecord:1,totalPage:1}}}),u=z(r.prototype,"setHistoryList",[h.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(n){e.historyList=n}}}),l=z(r.prototype,"rollBackStart",[h.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){var e=I(w().m((function e(n){var t,r;return w().w((function(e){for(;;)switch(e.n){case 0:return t=P(P({},n),{},{runWay:1,userId:Object(E.getUser)().userId}),e.n=1,E.Axios.post("/exec/rollBackStart",t);case 1:return 0!==(r=e.v).code&&g.default.error(r.msg),e.a(2,r)}}),e)})));return function(n){return e.apply(this,arguments)}}()}}),o=z(r.prototype,"execStart",[h.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){var e=I(w().m((function e(n){var t,r;return w().w((function(e){for(;;)switch(e.n){case 0:return t=P(P({},n),{},{runWay:1,userId:Object(E.getUser)().userId}),e.n=1,E.Axios.post("/exec/start",t);case 1:return 0!==(r=e.v).code&&g.default.error(r.msg),e.a(2,r)}}),e)})));return function(n){return e.apply(this,arguments)}}()}}),c=z(r.prototype,"execStop",[h.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){var e=I(w().m((function e(n){var t;return w().w((function(e){for(;;)switch(e.n){case 0:return(t=new FormData).append("pipelineId",n),e.n=1,E.Axios.post("/exec/stop",t);case 1:return e.a(2,e.v)}}),e)})));return function(n){return e.apply(this,arguments)}}()}}),m=z(r.prototype,"keepOn",[h.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){var e=I(w().m((function e(n){var t;return w().w((function(e){for(;;)switch(e.n){case 0:return(t=new FormData).append("pipelineId",n),e.n=1,E.Axios.post("/exec/keepOn",t);case 1:return e.a(2,e.v)}}),e)})));return function(n){return e.apply(this,arguments)}}()}}),s=z(r.prototype,"findTaskInstance",[h.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){var e=I(w().m((function e(n){var t;return w().w((function(e){for(;;)switch(e.n){case 0:return(t=new FormData).append("instanceId",n),e.n=1,E.Axios.post("/taskInstance/findTaskInstance",t);case 1:return e.a(2,e.v)}}),e)})));return function(n){return e.apply(this,arguments)}}()}}),f=z(r.prototype,"findStageInstance",[h.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){var e=I(w().m((function e(n){var t;return w().w((function(e){for(;;)switch(e.n){case 0:return(t=new FormData).append("instanceId",n),e.n=1,E.Axios.post("/stageInstance/findStageInstance",t);case 1:return e.a(2,e.v)}}),e)})));return function(n){return e.apply(this,arguments)}}()}}),b=z(r.prototype,"deleteInstance",[h.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){var e=I(w().m((function e(n){var t,r;return w().w((function(e){for(;;)switch(e.n){case 0:return(t=new FormData).append("instanceId",n),e.n=1,E.Axios.post("/instance/deleteInstance",t);case 1:return 0===(r=e.v).code&&g.default.success("删除成功"),e.a(2,r)}}),e)})));return function(n){return e.apply(this,arguments)}}()}}),p=z(r.prototype,"findUserInstance",[h.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var n=I(w().m((function n(t){var r;return w().w((function(n){for(;;)switch(n.n){case 0:return n.n=1,E.Axios.post("/instance/findUserInstance",t);case 1:return r=n.v,e.findHistoryList(r),n.a(2,r)}}),n)})));return function(e){return n.apply(this,arguments)}}()}}),d=z(r.prototype,"findPipelineInstance",[h.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var n=I(w().m((function n(t){var r;return w().w((function(n){for(;;)switch(n.n){case 0:return n.n=1,E.Axios.post("/instance/findPipelineInstance",t);case 1:return r=n.v,e.findHistoryList(r),n.a(2,r)}}),n)})));return function(e){return n.apply(this,arguments)}}()}}),N=z(r.prototype,"findHistoryList",[h.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(n){0===n.code&&n.data?(e.historyList=n.data.dataList,e.page={currentPage:n.data.currentPage,totalPage:n.data.totalPage,totalRecord:n.data.totalRecord}):(e.historyList=[],e.page={currentPage:1,totalPage:1,totalRecord:1})}}}),y=z(r.prototype,"findOneInstance",[h.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(e){var n=new FormData;return n.append("instanceId",e),E.Axios.post("/instance/findOneInstance",n)}}}),v=z(r.prototype,"findAllInstanceLogs",[h.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(e){var n=new FormData;return n.append("instanceId",e),E.Axios.post("/taskInstance/findAllInstanceLogs",n)}}}),_=z(r.prototype,"findAllStageInstanceLogs",[h.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(e){var n=new FormData;return n.append("instanceId",e),E.Axios.post("/stageInstance/findAllStageInstanceLogs",n)}}}),r);n.a=D},755:function(e,n,t){"use strict";t(170);var r,a,i,u,l,o,c=t(56),m=t(12),s=t(9);function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,n,t="function"==typeof Symbol?Symbol:{},r=t.iterator||"@@iterator",a=t.toStringTag||"@@toStringTag";function i(t,r,a,i){var o=r&&r.prototype instanceof l?r:l,c=Object.create(o.prototype);return p(c,"_invoke",function(t,r,a){var i,l,o,c=0,m=a||[],s=!1,f={p:0,n:0,v:e,a:b,f:b.bind(e,4),d:function(n,t){return i=n,l=0,o=e,f.n=t,u}};function b(t,r){for(l=t,o=r,n=0;!s&&c&&!a&&n<m.length;n++){var a,i=m[n],b=f.p,p=i[2];t>3?(a=p===r)&&(o=i[(l=i[4])?5:(l=3,3)],i[4]=i[5]=e):i[0]<=b&&((a=t<2&&b<i[1])?(l=0,f.v=r,f.n=i[1]):b<p&&(a=t<3||i[0]>r||r>p)&&(i[4]=t,i[5]=r,f.n=p,l=0))}if(a||t>1)return u;throw s=!0,r}return function(a,m,p){if(c>1)throw TypeError("Generator is already running");for(s&&1===m&&b(m,p),l=m,o=p;(n=l<2?e:o)||!s;){i||(l?l<3?(l>1&&(f.n=-1),b(l,o)):f.n=o:f.v=o);try{if(c=2,i){if(l||(a="next"),n=i[a]){if(!(n=n.call(i,o)))throw TypeError("iterator result is not an object");if(!n.done)return n;o=n.value,l<2&&(l=0)}else 1===l&&(n=i.return)&&n.call(i),l<2&&(o=TypeError("The iterator does not provide a '"+a+"' method"),l=1);i=e}else if((n=(s=f.n<0)?o:t.call(r,f))!==u)break}catch(n){i=e,l=1,o=n}finally{c=1}}return{value:n,done:s}}}(t,a,i),!0),c}var u={};function l(){}function o(){}function c(){}n=Object.getPrototypeOf;var m=[][r]?n(n([][r]())):(p(n={},r,(function(){return this})),n),s=c.prototype=l.prototype=Object.create(m);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,p(e,a,"GeneratorFunction")),e.prototype=Object.create(s),e}return o.prototype=c,p(s,"constructor",c),p(c,"constructor",o),o.displayName="GeneratorFunction",p(c,a,"GeneratorFunction"),p(s),p(s,a,"Generator"),p(s,r,(function(){return this})),p(s,"toString",(function(){return"[object Generator]"})),(b=function(){return{w:i,m:f}})()}function p(e,n,t,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}(p=function(e,n,t,r){if(n)a?a(e,n,{value:t,enumerable:!r,configurable:!r,writable:!r}):e[n]=t;else{var i=function(n,t){p(e,n,(function(e){return this._invoke(n,t,e)}))};i("next",0),i("throw",1),i("return",2)}})(e,n,t,r)}function d(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function N(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?d(Object(t),!0).forEach((function(n){E(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):d(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function y(e,n,t,r,a,i,u){try{var l=e[i](u),o=l.value}catch(e){return void t(e)}l.done?n(o):Promise.resolve(o).then(r,a)}function v(e){return function(){var n=this,t=arguments;return new Promise((function(r,a){var i=e.apply(n,t);function u(e){y(i,r,a,u,l,"next",e)}function l(e){y(i,r,a,u,l,"throw",e)}u(void 0)}))}}function _(e,n,t,r){t&&Object.defineProperty(e,n,{enumerable:t.enumerable,configurable:t.configurable,writable:t.writable,value:t.initializer?t.initializer.call(r):void 0})}function g(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,O(r.key),r)}}function h(e,n,t){return n&&g(e.prototype,n),t&&g(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function E(e,n,t){return(n=O(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function O(e){var n=function(e,n){if("object"!=f(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n||"default");if("object"!=f(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==f(n)?n:n+""}function w(e,n,t,r,a){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=t.slice().reverse().reduce((function(t,r){return r(e,n,t)||t}),i),a&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(a):void 0,i.initializer=void 0),void 0===i.initializer?(Object.defineProperty(e,n,i),null):i}var j=(a=w((r=h((function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),_(this,"createEnv",a,this),_(this,"deleteEnv",i,this),_(this,"updateEnv",u,this),_(this,"findEnvList",l,this),_(this,"findEnvPage",o,this)}))).prototype,"createEnv",[m.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){var e=v(b().m((function e(n){var t,r;return b().w((function(e){for(;;)switch(e.n){case 0:return t=N({user:{id:Object(s.getUser)().userId}},n),e.n=1,s.Axios.post("/env/createEnv",t);case 1:return 0===(r=e.v).code?c.default.success("添加成功"):c.default.error("添加失败"),e.a(2,r)}}),e)})));return function(n){return e.apply(this,arguments)}}()}}),i=w(r.prototype,"deleteEnv",[m.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){var e=v(b().m((function e(n){var t,r;return b().w((function(e){for(;;)switch(e.n){case 0:return(t=new FormData).append("envId",n),e.n=1,s.Axios.post("/env/deleteEnv",t);case 1:return 0===(r=e.v).code?c.default.success("删除成功"):c.default.error("删除失败"),e.a(2,r)}}),e)})));return function(n){return e.apply(this,arguments)}}()}}),u=w(r.prototype,"updateEnv",[m.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){var e=v(b().m((function e(n){var t;return b().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,s.Axios.post("/env/updateEnv",n);case 1:return 0===(t=e.v).code?c.default.success("修改成功"):c.default.error("修改失败"),e.a(2,t)}}),e)})));return function(n){return e.apply(this,arguments)}}()}}),l=w(r.prototype,"findEnvList",[m.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return v(b().m((function e(){return b().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,s.Axios.post("/env/findEnvList",{});case 1:return e.a(2,e.v)}}),e)})))}}),o=w(r.prototype,"findEnvPage",[m.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){var e=v(b().m((function e(n){return b().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,s.Axios.post("/env/findEnvPage",n);case 1:return e.a(2,e.v)}}),e)})));return function(n){return e.apply(this,arguments)}}()}}),r);n.a=new j},906:function(e,n,t){"use strict";var r=t(0),a=t.n(r),i="/Users/gaomengyuan/tiklab/tiklab-arbess-ui/src/common/component/tabs/Tabs.js";n.a=function(e){var n=e.tabLis,t=e.type,r=e.onClick;return a.a.createElement("div",{className:"arbess-tabs",__source:{fileName:i,lineNumber:16,columnNumber:9}},n.map((function(e){return a.a.createElement("div",{key:e.id,className:"arbess-tab ".concat(t===e.id?"arbess-active-tab":""),onClick:t===e.id?void 0:function(){return r(e)},__source:{fileName:i,lineNumber:19,columnNumber:21}},e.title)})))}},937:function(e,n,t){"use strict";t(520);var r=t(519),a=(t(264),t(124)),i=(t(396),t(278)),u=t.n(i),l=(t(172),t(71)),o=(t(151),t(47)),c=(t(260),t(150)),m=(t(261),t(171)),s=(t(262),t(72)),f=t(0),b=t.n(f),p=t(349),d=t(350),N=t(184),y=t(44),v=t(9),_=t(154),g=t(152),h=t(174),E=t(596),O=t(270);function w(e){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var j="/Users/gaomengyuan/tiklab/tiklab-arbess-ui/src/pipeline/pipeline/components/PipelineUserAdd.js";function S(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function P(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?S(Object(t),!0).forEach((function(n){k(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):S(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function k(e,n,t){return(n=function(e){var n=function(e,n){if("object"!=w(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n||"default");if("object"!=w(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==w(n)?n:n+""}(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function I(e){return function(e){if(Array.isArray(e))return C(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||x(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,a,i,u,l=[],o=!0,c=!1;try{if(i=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;o=!1}else for(;!(o=(r=i.call(t)).done)&&(l.push(r.value),l.length!==n);o=!0);}catch(e){c=!0,a=e}finally{try{if(!o&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(c)throw a}}return l}}(e,n)||x(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(e,n){if(e){if("string"==typeof e)return C(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?C(e,n):void 0}}function C(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}var T=function(e){var n=e.setVisible,t=e.yUserList,a=e.setYUserList,i=e.pipelineStore.findUserPage,u=A(Object(f.useState)([]),2),l=u[0],o=u[1],c=A(Object(f.useState)([]),2),m=c[0],s=c[1],p=A(Object(f.useState)([]),2),d=p[0],N=p[1],y=A(Object(f.useState)({pageSize:5,currentPage:1}),1)[0],v=A(Object(f.useState)({pageParam:y}),2),_=v[0],w=v[1],S=A(Object(f.useState)({}),2),k=S[0],x=S[1];Object(f.useEffect)((function(){C()}),[_]);var C=function(){i(_).then((function(e){var n;0===e.code&&(s((null===(n=e.data)||void 0===n?void 0:n.dataList)||[]),x({currentPage:e.data.currentPage,totalPage:e.data.totalPage,totalRecord:e.data.totalRecord}))}))},T=function(e){return t&&t.some((function(n){return n.id===e.id}))},L=function(e){if(!T(e)){var n=e.id,t=I(d),r=I(l),a=t.indexOf(n);if(a>=0){t.splice(a,1);var i=r.findIndex((function(e){return e.id===n}));i>=0&&r.splice(i,1)}else t.push(n),r.push(P(P({},e),{},{roleType:0}));N(t),o(r)}},z={onSelectAll:function(e,n,t){var r,a,i=t.map((function(e){return e&&e.id})).filter(Boolean),u=t.map((function(e){return P(P({},e),{},{roleType:0})})).filter(Boolean);e?(r=Array.from(new Set([].concat(I(d),I(i)))),a=Array.from(new Set([].concat(I(l),I(u))))):(r=d.filter((function(e){return!i.includes(e)})),a=l.filter((function(e){return!i.includes(e.id)}))),N(r),o(a)},onSelect:function(e){L(e)},getCheckboxProps:function(e){return{disabled:T(e)}},selectedRowKeys:d};return b.a.createElement("div",{className:"pipeline-user-add",__source:{fileName:j,lineNumber:168,columnNumber:9}},b.a.createElement(O.a,{placeholder:"搜索姓名",onPressEnter:function(e){w({pageParam:y,nickname:e.target.value})},__source:{fileName:j,lineNumber:169,columnNumber:13}}),b.a.createElement("div",{className:"pipeline-user-add-table",__source:{fileName:j,lineNumber:173,columnNumber:13}},b.a.createElement(r.default,{rowKey:function(e){return e.id},rowSelection:z,onRow:function(e){return{onClick:function(){return L(e)}}},columns:[{title:"姓名",dataIndex:"nickname",key:"nickname",width:"100%",ellipsis:!0}],dataSource:m,pagination:!1,locale:{emptyText:b.a.createElement(h.a,{__source:{fileName:j,lineNumber:189,columnNumber:41}})},__source:{fileName:j,lineNumber:174,columnNumber:17}}),b.a.createElement(E.a,{currentPage:_.pageParam.currentPage,changPage:function(e){w(P(P({},_),{},{pageParam:{pageSize:5,currentPage:e}}))},page:k,__source:{fileName:j,lineNumber:192,columnNumber:17}})),b.a.createElement("div",{className:"pipeline-user-add-btn",__source:{fileName:j,lineNumber:198,columnNumber:13}},b.a.createElement(g.a,{onClick:function(){return n(!1)},title:"取消",isMar:!0,__source:{fileName:j,lineNumber:199,columnNumber:17}}),b.a.createElement(g.a,{onClick:function(){var e=Array.from(new Set([].concat(I(t),I(l))));a(e),n(!1)},title:"确定",type:"primary",__source:{fileName:j,lineNumber:200,columnNumber:17}})))},L=t(755),z=t(861),D=t(177);function F(e){return(F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var U="/Users/gaomengyuan/tiklab/tiklab-arbess-ui/src/pipeline/pipeline/components/PipelineAddInfo.js";function R(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function V(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?R(Object(t),!0).forEach((function(n){M(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):R(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function M(e,n,t){return(n=function(e){var n=function(e,n){if("object"!=F(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n||"default");if("object"!=F(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==F(n)?n:n+""}(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function G(e){return function(e){if(Array.isArray(e))return $(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||H(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function B(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,a,i,u,l=[],o=!0,c=!1;try{if(i=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;o=!1}else for(;!(o=(r=i.call(t)).done)&&(l.push(r.value),l.length!==n);o=!0);}catch(e){c=!0,a=e}finally{try{if(!o&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(c)throw a}}return l}}(e,n)||H(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function H(e,n){if(e){if("string"==typeof e)return $(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?$(e,n):void 0}}function $(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}var J=Object(f.forwardRef)((function(e,n){var t=e.set,i=e.setCurrent,y=e.baseInfo,E=e.setBaseInfo,O=e.onClick,w=e.pipeline,j=e.setPipeline,S=e.changFresh,P=D.a.findUserPipeline,k=D.a.updatePipeline,I=D.a.pipelineList,A=L.a.findEnvList,x=z.a.findGroupList,C=B(s.default.useForm(),1)[0],F=Object(v.getUser)(),R=B(Object(f.useState)(!1),2),M=R[0],H=R[1],$=B(Object(f.useState)((null==y?void 0:y.type)||1),2),J=($[0],$[1],B(Object(f.useState)(1),2)),K=J[0],Y=J[1],q=B(Object(f.useState)((null==y?void 0:y.userList)||[]),2),W=q[0],Z=q[1],Q=B(Object(f.useState)([]),2),X=Q[0],ee=Q[1],ne=B(Object(f.useState)([]),2),te=ne[0],re=ne[1];Object(f.useEffect)((function(){ae(),t||(Y((null==y?void 0:y.power)||1),P().then())}),[]),Object(f.useEffect)((function(){w&&(C.setFieldsValue(w),Y(null==w?void 0:w.power))}),[w]);var ae=function(){A().then((function(e){0===e.code&&ee(e.data||[])})),x().then((function(e){0===e.code&&re(e.data||[])}))},ie=function(){C.validateFields().then((function(n){if(t){var r=V(V({},n),{},{id:w.id,name:""===n.name?w.name:n.name,power:K});k(r).then((function(n){0===n.code&&("function"==typeof S?(O(),S()):(j(V(V({},w),r)),e.history.push("/pipeline/".concat(w.id,"/overview"))))}))}else i(1),E(V(V({},n),{},{type:2,power:K,userList:W}))}))},ue=function(){C.resetFields()};Object(f.useImperativeHandle)(n,(function(){return{onOk:ie,onRest:ue}}));var le=[{id:1,title:"全局",icon:b.a.createElement(p.a,{__source:{fileName:U,lineNumber:157,columnNumber:18}}),desc:"公共项目，全部成员可见。不支持TFVC等某些功能。"},{id:2,title:"私有",icon:b.a.createElement(d.a,{__source:{fileName:U,lineNumber:163,columnNumber:18}}),desc:"只有您授予访问权限的人才能查看此项目。"}],oe=b.a.createElement(s.default.Item,{className:"pipeline-power",label:"流水线权限",__source:{fileName:U,lineNumber:170,columnNumber:9}},b.a.createElement("div",{className:"pipeline-power-content",__source:{fileName:U,lineNumber:171,columnNumber:13}},le.map((function(e){return b.a.createElement("div",{key:e.id,className:"pipeline-power-item ".concat(t?"pipeline-power-set":"pipeline-power-noSet"," ").concat(K===e.id?"pipeline-power-select":""),onClick:function(){return Y(e.id)},__source:{fileName:U,lineNumber:174,columnNumber:32}},b.a.createElement("div",{className:"power-item",__source:{fileName:U,lineNumber:179,columnNumber:29}},b.a.createElement("div",{__source:{fileName:U,lineNumber:180,columnNumber:33}},b.a.createElement("div",{className:"power-title power-icon",__source:{fileName:U,lineNumber:181,columnNumber:37}},e.icon),b.a.createElement("div",{className:"power-title power-name",__source:{fileName:U,lineNumber:182,columnNumber:37}},e.title))),b.a.createElement("div",{className:"power-desc",__source:{fileName:U,lineNumber:185,columnNumber:29}},e.desc))})))),ce=[{title:"姓名",dataIndex:"nickname",key:"nickname",width:"35%",ellipsis:!0,render:function(e){return e||"--"}},{title:"名称",dataIndex:"name",key:"name",width:"30%",ellipsis:!0,render:function(e,n){return b.a.createElement(m.default,{__source:{fileName:U,lineNumber:210,columnNumber:21}},b.a.createElement(_.a,{userInfo:n,__source:{fileName:U,lineNumber:211,columnNumber:25}}),e||"--")}},{title:"权限",dataIndex:"roleType",key:"roleType",width:"28",ellipsis:!0,render:function(e,n){return b.a.createElement(c.default,{bordered:!1,showarrow:"false",style:{width:120},defaultValue:n.roleType,disabled:n.id===F.userId,onChange:function(e){return function(e,n){W&&W.map((function(t){t.id===e.id&&(t.roleType=n)})),Z(G(W))}(n,e)},__source:{fileName:U,lineNumber:224,columnNumber:17}},n.id===F.userId&&b.a.createElement(c.default.Option,{value:2,__source:{fileName:U,lineNumber:234,columnNumber:25}},"超级管理员"),b.a.createElement(c.default.Option,{value:1,__source:{fileName:U,lineNumber:236,columnNumber:21}},"管理员角色"),b.a.createElement(c.default.Option,{value:0,__source:{fileName:U,lineNumber:237,columnNumber:21}},"默认角色"))}},{title:"操作",dataIndex:"action",key:"action",width:"7%",ellipsis:!0,render:function(e,n){return n.id!==F.userId?b.a.createElement(o.default,{title:"移出用户",__source:{fileName:U,lineNumber:250,columnNumber:25}},b.a.createElement(N.default,{onClick:function(){return function(e){Z(W.filter((function(n){return n.id!==e.id})))}(n)},__source:{fileName:U,lineNumber:251,columnNumber:29}})):b.a.createElement("span",{className:"user-table-ban",__source:{fileName:U,lineNumber:256,columnNumber:21}},b.a.createElement(N.default,{__source:{fileName:U,lineNumber:257,columnNumber:26}}))}}],me=[{required:!t,message:"名称不能为空"},{pattern:/^[\u4e00-\u9fa5a-zA-Z0-9_-]{0,50}$/,message:"流水线名称最长50位且不能包含非法字符，如&,%，&，#……等"},function(e){e.getFieldValue;return{validator:function(e,n){return(t?I&&I.map((function(e){return e.name})).filter((function(e){return e!==w.name})):I&&I.map((function(e){return e.name}))).includes(n)?Promise.reject("名称已经存在"):Promise.resolve()}}}],se=B(Object(f.useState)(0),2),fe=se[0],be=se[1];return Object(f.useEffect)((function(){var e;t&&be((null==w||null===(e=w.name)||void 0===e?void 0:e.length)||0)}),[w]),t?b.a.createElement(b.a.Fragment,null,b.a.createElement(s.default,{form:C,autoComplete:"off",layout:"vertical",initialValues:w,__source:{fileName:U,lineNumber:301,columnNumber:17}},b.a.createElement(s.default.Item,{label:"流水线名称",name:"name",rules:me,__source:{fileName:U,lineNumber:307,columnNumber:21}},b.a.createElement(l.default,{allowClear:!0,placeholder:"流水线名称",maxLength:50,suffix:b.a.createElement("span",{style:{color:"#999"},__source:{fileName:U,lineNumber:312,columnNumber:37}},fe,"/50"),onChange:function(e){return be(e.target.value.length)},__source:{fileName:U,lineNumber:308,columnNumber:25}})),b.a.createElement(s.default.Item,{label:"流水线应用",name:["group","id"],__source:{fileName:U,lineNumber:316,columnNumber:21}},b.a.createElement(c.default,{placeholder:"流水线应用",__source:{fileName:U,lineNumber:317,columnNumber:25}},te&&te.map((function(e){return b.a.createElement(c.default.Option,{value:e.id,key:e.id,__source:{fileName:U,lineNumber:320,columnNumber:37}},e.groupName)})))),b.a.createElement(s.default.Item,{label:"流水线环境",name:["env","id"],__source:{fileName:U,lineNumber:325,columnNumber:21}},b.a.createElement(c.default,{placeholder:"流水线环境",__source:{fileName:U,lineNumber:326,columnNumber:25}},X&&X.map((function(e){return b.a.createElement(c.default.Option,{value:e.id,key:e.id,__source:{fileName:U,lineNumber:329,columnNumber:37}},e.envName)})))),oe),"function"==typeof S?null:b.a.createElement(b.a.Fragment,null,b.a.createElement(g.a,{onClick:O,title:"取消",isMar:!0,__source:{fileName:U,lineNumber:339,columnNumber:29}}),b.a.createElement(u.a,{code:"pipeline_update",domainId:w&&w.id,__source:{fileName:U,lineNumber:340,columnNumber:29}},b.a.createElement(g.a,{type:"primary",title:"确定",onClick:ie,__source:{fileName:U,lineNumber:341,columnNumber:33}})))):b.a.createElement(s.default,{form:C,autoComplete:"off",layout:"vertical",initialValues:y,__source:{fileName:U,lineNumber:350,columnNumber:9}},b.a.createElement(s.default.Item,{label:"流水线名称",name:"name",rules:me,__source:{fileName:U,lineNumber:356,columnNumber:13}},b.a.createElement(l.default,{allowClear:!0,placeholder:"流水线名称",maxLength:50,suffix:b.a.createElement("span",{style:{color:"#999"},__source:{fileName:U,lineNumber:365,columnNumber:29}},fe,"/50"),onChange:function(e){return be(e.target.value.length)},__source:{fileName:U,lineNumber:361,columnNumber:17}})),b.a.createElement(s.default.Item,{label:"流水线应用",name:["group","id"],__source:{fileName:U,lineNumber:369,columnNumber:13}},b.a.createElement(c.default,{placeholder:"流水线应用",__source:{fileName:U,lineNumber:370,columnNumber:17}},te&&te.map((function(e){return b.a.createElement(c.default.Option,{value:e.id,key:e.id,__source:{fileName:U,lineNumber:373,columnNumber:29}},e.groupName)})))),b.a.createElement(s.default.Item,{label:"流水线环境",name:["env","id"],__source:{fileName:U,lineNumber:378,columnNumber:13}},b.a.createElement(c.default,{placeholder:"流水线环境",__source:{fileName:U,lineNumber:379,columnNumber:17}},X&&X.map((function(e){return b.a.createElement(c.default.Option,{value:e.id,key:e.id,__source:{fileName:U,lineNumber:382,columnNumber:29}},e.envName)})))),oe,2===K&&b.a.createElement(s.default.Item,{className:"pipeline-user",__source:{fileName:U,lineNumber:390,columnNumber:17}},b.a.createElement("div",{className:"pipeline-user-title ant-form-item-label",__source:{fileName:U,lineNumber:391,columnNumber:21}},b.a.createElement("label",{__source:{fileName:U,lineNumber:392,columnNumber:25}},"通知对象"),b.a.createElement(a.default,{getPopupContainer:function(e){return e.parentElement},overlay:b.a.createElement(T,{setVisible:H,yUserList:W,setYUserList:Z,pipelineStore:D.a,__source:{fileName:U,lineNumber:396,columnNumber:33}}),visible:M,onVisibleChange:function(e){return H(e)},trigger:["click"],placement:"bottomRight",overlayStyle:{width:240},__source:{fileName:U,lineNumber:393,columnNumber:25}},b.a.createElement(g.a,{type:"link-nopadding",title:"添加成员",__source:{fileName:U,lineNumber:409,columnNumber:29}}))),b.a.createElement("div",{className:"pipeline-user-table",__source:{fileName:U,lineNumber:415,columnNumber:21}},b.a.createElement(r.default,{rowKey:function(e){return e.id},columns:ce,dataSource:W,pagination:!1,showHeader:!1,locale:{emptyText:b.a.createElement(h.a,{__source:{fileName:U,lineNumber:422,columnNumber:49}})},__source:{fileName:U,lineNumber:416,columnNumber:25}}))))}));n.a=Object(y.observer)(J)},950:function(e,n,t){"use strict";n.a=t.p+"images/pip_xingxing.svg"},951:function(e,n,t){"use strict";n.a=t.p+"images/pip_xingxing_kong.svg"},952:function(e,n,t){"use strict";n.a=t.p+"images/pip_setting.svg"},989:function(e,n,t){"use strict";t(173);var r=t(97),a=(t(172),t(71)),i=t(0),u=t.n(i),l=t(268),o=t(177),c=t(579),m="/Users/gaomengyuan/tiklab/tiklab-arbess-ui/src/pipeline/pipeline/components/PipelineDelete.js";function s(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,a,i,u,l=[],o=!0,c=!1;try{if(i=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;o=!1}else for(;!(o=(r=i.call(t)).done)&&(l.push(r.value),l.length!==n);o=!0);}catch(e){c=!0,a=e}finally{try{if(!o&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(c)throw a}}return l}}(e,n)||function(e,n){if(e){if("string"==typeof e)return f(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?f(e,n):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}n.a=function(e){var n=e.delVisible,t=e.setDelVisible,f=e.pipeline,b=e.changPage,p=e.page,d=o.a.deletePipeline,N=s(Object(i.useState)(""),2),y=N[0],v=N[1],_=s(Object(i.useState)(null),2),g=_[0],h=_[1],E=s(Object(i.useState)(!1),2),O=E[0],w=E[1],j=function(){O||(w(!1),t(!1),v(""),h(null))};return u.a.createElement(l.a,{visible:n,onCancel:j,onOk:function(){O||(""!==y.trim()&&y===f.name?(w(!0),d(f.id).then((function(){if(j(),"function"==typeof b){var n=Object(c.d)(p.totalRecord,15,p.currentPage);b(n)}else e.history.push("/pipeline")}))):h("流水线名称错误"))},title:"删除流水线",okText:"确认删除",okType:"dangerous",__source:{fileName:m,lineNumber:64,columnNumber:9}},u.a.createElement(r.a,{spinning:O,tip:"删除中...",__source:{fileName:m,lineNumber:72,columnNumber:13}},u.a.createElement("div",{className:"pipelineReDel-modal",__source:{fileName:m,lineNumber:73,columnNumber:17}},u.a.createElement("div",{className:"pipelineReDel-modal-warn",__source:{fileName:m,lineNumber:74,columnNumber:21}},"危险：流水线删除无法恢复！请慎重操作！"),u.a.createElement("div",{className:"pipelineReDel-modal-warn",__source:{fileName:m,lineNumber:75,columnNumber:21}},u.a.createElement("div",{__source:{fileName:m,lineNumber:76,columnNumber:25}},"该操作将永久删除流水线",u.a.createElement("span",{className:"warn-pipeline",__source:{fileName:m,lineNumber:76,columnNumber:41}}," ",null==f?void 0:f.name," "),"的相关数据，包括（配置、历史、制品）等。"),u.a.createElement("div",{className:"warn-continue",__source:{fileName:m,lineNumber:77,columnNumber:25}},"为防止意外，确认继续操作请输入以下内容："),u.a.createElement("div",{className:"warn-pipeline-title",__source:{fileName:m,lineNumber:78,columnNumber:25}},null==f?void 0:f.name)),u.a.createElement("div",{className:"pipelineReDel-modal-input",__source:{fileName:m,lineNumber:80,columnNumber:21}},u.a.createElement(a.default,{className:"".concat(g?"inputs-error":""),placeholder:"请输入提示内容以确认继续操作",onChange:function(e){return v(e.target.value)},__source:{fileName:m,lineNumber:81,columnNumber:25}})),u.a.createElement("div",{className:"pipelineReDel-modal-error",__source:{fileName:m,lineNumber:87,columnNumber:21}},g))))}}}]);