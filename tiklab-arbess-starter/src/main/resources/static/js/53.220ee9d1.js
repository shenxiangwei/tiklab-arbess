(window.webpackJsonp=window.webpackJsonp||[]).push([[53],{1430:function(e,r,n){"use strict";n.r(r);n(521);var t=n(523),i=(n(522),n(524)),a=(n(396),n(278)),l=n.n(a),u=n(0),o=n.n(u),c=n(182),m=n(184),s=n(135),f=n(91),b=n(44),p=n(937),N=n(989),d=n(594),y=n(152),v="/Users/gaomengyuan/tiklab/tiklab-arbess-ui/src/pipeline/setting/basicInfo/BasicInfo.js";function _(){return(_=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var t in n)({}).hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e}).apply(null,arguments)}function g(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var t,i,a,l,u=[],o=!0,c=!1;try{if(a=(n=n.call(e)).next,0===r){if(Object(n)!==n)return;o=!1}else for(;!(o=(t=a.call(n)).done)&&(u.push(t.value),u.length!==r);o=!0);}catch(e){c=!0,i=e}finally{try{if(!o&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(c)throw i}}return u}}(e,r)||function(e,r){if(e){if("string"==typeof e)return E(e,r);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?E(e,r):void 0}}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function E(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,t=Array(r);n<r;n++)t[n]=e[n];return t}r.default=Object(b.inject)("pipelineStore")(Object(b.observer)((function(e){var r=e.pipelineStore,n=r.pipeline,a=r.setPipeline,b=g(Object(u.useState)([]),2),E=b[0],h=b[1],w=g(Object(u.useState)(!1),2),O=w[0],j=w[1],S=[{key:1,title:"流水线信息",desc:"更新流水线信息",icon:o.a.createElement(c.default,{__source:{fileName:v,lineNumber:40,columnNumber:19}}),enCode:"pipeline_update",content:o.a.createElement("div",{className:"bottom-rename",__source:{fileName:v,lineNumber:43,columnNumber:17}},o.a.createElement(p.a,_({},e,{set:!0,pipeline:n,setPipeline:a,onClick:function(){return k(1)},__source:{fileName:v,lineNumber:44,columnNumber:21}})))},{key:2,title:"流水线删除",desc:"删除流水线",icon:o.a.createElement(m.default,{__source:{fileName:v,lineNumber:58,columnNumber:19}}),enCode:"pipeline_delete",content:o.a.createElement("div",{className:"bottom-delete",__source:{fileName:v,lineNumber:61,columnNumber:17}},o.a.createElement("div",{style:{color:"#ff0000",paddingBottom:5,fontSize:13},__source:{fileName:v,lineNumber:62,columnNumber:21}},"此操作无法恢复！请慎重操作！"),o.a.createElement(y.a,{onClick:function(){return k(2)},title:"取消",isMar:!0,__source:{fileName:v,lineNumber:65,columnNumber:21}}),o.a.createElement(l.a,{code:"pipeline_delete",domainId:n&&n.id,__source:{fileName:v,lineNumber:70,columnNumber:21}},o.a.createElement(y.a,{onClick:function(){return j(!0)},type:"dangerous",title:"删除",__source:{fileName:v,lineNumber:71,columnNumber:25}})))}],P=function(e){return E.some((function(r){return r===e}))},k=function(e){P(e)?h(E.filter((function(r){return r!==e}))):h(E.concat(e))};return o.a.createElement(t.default,{className:"pipelineReDel",__source:{fileName:v,lineNumber:129,columnNumber:9}},o.a.createElement(i.default,{xs:{span:"24"},sm:{span:"24"},md:{span:"24"},lg:{span:"24"},xl:{span:"16",offset:"4"},xxl:{span:"14",offset:"5"},__source:{fileName:v,lineNumber:130,columnNumber:13}},o.a.createElement("div",{className:"arbess-home-limited",__source:{fileName:v,lineNumber:138,columnNumber:17}},o.a.createElement("div",{className:"pipelineReDel-up",__source:{fileName:v,lineNumber:139,columnNumber:21}},o.a.createElement(d.a,{crumbs:[{title:"流水线信息"}],__source:{fileName:v,lineNumber:140,columnNumber:25}})),o.a.createElement("div",{className:"pipelineReDel-content",__source:{fileName:v,lineNumber:146,columnNumber:21}},o.a.createElement("div",{className:"pipelineReDel-ul",__source:{fileName:v,lineNumber:147,columnNumber:25}},S.map((function(e){return function(e){return o.a.createElement("div",{key:e.key,className:"pipelineReDel-li",__source:{fileName:v,lineNumber:106,columnNumber:16}},o.a.createElement("div",{className:"pipelineReDel-li-top ".concat(P(e.key)?"pipelineReDel-li-select":"pipelineReDel-li-unSelect"),onClick:function(){return k(e.key)},__source:{fileName:v,lineNumber:107,columnNumber:13}},o.a.createElement("div",{className:"pipelineReDel-li-icon",__source:{fileName:v,lineNumber:110,columnNumber:17}},e.icon),o.a.createElement("div",{className:"pipelineReDel-li-center",__source:{fileName:v,lineNumber:111,columnNumber:17}},o.a.createElement("div",{className:"pipelineReDel-li-title",__source:{fileName:v,lineNumber:112,columnNumber:21}},e.title),!P(e.key)&&o.a.createElement("div",{className:"pipelineReDel-li-desc",__source:{fileName:v,lineNumber:115,columnNumber:25}},e.desc)),o.a.createElement("div",{className:"pipelineReDel-li-down",__source:{fileName:v,lineNumber:118,columnNumber:17}},P(e.key)?o.a.createElement(s.a,{__source:{fileName:v,lineNumber:119,columnNumber:49}}):o.a.createElement(f.default,{__source:{fileName:v,lineNumber:119,columnNumber:66}}))),o.a.createElement("div",{className:"".concat(P(e.key)?"pipelineReDel-li-bottom":"pipelineReDel-li-none"),__source:{fileName:v,lineNumber:122,columnNumber:13}},P(e.key)&&e.content))}(e)}))))),o.a.createElement(N.a,_({},e,{pipeline:n,delVisible:O,setDelVisible:j,__source:{fileName:v,lineNumber:154,columnNumber:17}}))))})))},596:function(e,r,n){"use strict";var t=n(0),i=n.n(t),a=n(115),l=n(91),u=n(294),o="/Users/gaomengyuan/tiklab/tiklab-arbess-ui/src/common/component/page/Page.js";r.a=function(e){var r=e.currentPage,n=e.changPage,t=e.page,c=t.totalPage,m=void 0===c?1:c,s=t.totalRecord,f=void 0===s?1:s;return m>1&&i.a.createElement("div",{className:"arbess-page",__source:{fileName:o,lineNumber:17,columnNumber:9}},i.a.createElement("div",{className:"arbess-page-record",__source:{fileName:o,lineNumber:18,columnNumber:13}},"  共",f,"条 "),i.a.createElement("div",{className:"".concat(1===r?"arbess-page-ban":"arbess-page-allow"),onClick:function(){return 1===r?null:n(r-1)},__source:{fileName:o,lineNumber:19,columnNumber:13}},i.a.createElement(a.default,{__source:{fileName:o,lineNumber:21,columnNumber:14}})),i.a.createElement("div",{className:"arbess-page-current",__source:{fileName:o,lineNumber:22,columnNumber:13}},r),i.a.createElement("div",{className:"arbess-page-line",__source:{fileName:o,lineNumber:23,columnNumber:13}}," / "),i.a.createElement("div",{__source:{fileName:o,lineNumber:24,columnNumber:13}},m),i.a.createElement("div",{className:"".concat(r===m?"arbess-page-ban":"arbess-page-allow"),onClick:function(){return r===m?null:n(r+1)},__source:{fileName:o,lineNumber:25,columnNumber:13}},i.a.createElement(l.default,{__source:{fileName:o,lineNumber:27,columnNumber:14}})),i.a.createElement("div",{className:"arbess-page-fresh",onClick:function(){return n(1)},__source:{fileName:o,lineNumber:28,columnNumber:13}},i.a.createElement(u.default,{__source:{fileName:o,lineNumber:29,columnNumber:17}})))}},755:function(e,r,n){"use strict";n(170);var t,i,a,l,u,o,c=n(56),m=n(12),s=n(9);function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,r,n="function"==typeof Symbol?Symbol:{},t=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function a(n,t,i,a){var o=t&&t.prototype instanceof u?t:u,c=Object.create(o.prototype);return p(c,"_invoke",function(n,t,i){var a,u,o,c=0,m=i||[],s=!1,f={p:0,n:0,v:e,a:b,f:b.bind(e,4),d:function(r,n){return a=r,u=0,o=e,f.n=n,l}};function b(n,t){for(u=n,o=t,r=0;!s&&c&&!i&&r<m.length;r++){var i,a=m[r],b=f.p,p=a[2];n>3?(i=p===t)&&(o=a[(u=a[4])?5:(u=3,3)],a[4]=a[5]=e):a[0]<=b&&((i=n<2&&b<a[1])?(u=0,f.v=t,f.n=a[1]):b<p&&(i=n<3||a[0]>t||t>p)&&(a[4]=n,a[5]=t,f.n=p,u=0))}if(i||n>1)return l;throw s=!0,t}return function(i,m,p){if(c>1)throw TypeError("Generator is already running");for(s&&1===m&&b(m,p),u=m,o=p;(r=u<2?e:o)||!s;){a||(u?u<3?(u>1&&(f.n=-1),b(u,o)):f.n=o:f.v=o);try{if(c=2,a){if(u||(i="next"),r=a[i]){if(!(r=r.call(a,o)))throw TypeError("iterator result is not an object");if(!r.done)return r;o=r.value,u<2&&(u=0)}else 1===u&&(r=a.return)&&r.call(a),u<2&&(o=TypeError("The iterator does not provide a '"+i+"' method"),u=1);a=e}else if((r=(s=f.n<0)?o:n.call(t,f))!==l)break}catch(r){a=e,u=1,o=r}finally{c=1}}return{value:r,done:s}}}(n,i,a),!0),c}var l={};function u(){}function o(){}function c(){}r=Object.getPrototypeOf;var m=[][t]?r(r([][t]())):(p(r={},t,(function(){return this})),r),s=c.prototype=u.prototype=Object.create(m);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,p(e,i,"GeneratorFunction")),e.prototype=Object.create(s),e}return o.prototype=c,p(s,"constructor",c),p(c,"constructor",o),o.displayName="GeneratorFunction",p(c,i,"GeneratorFunction"),p(s),p(s,i,"Generator"),p(s,t,(function(){return this})),p(s,"toString",(function(){return"[object Generator]"})),(b=function(){return{w:a,m:f}})()}function p(e,r,n,t){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}(p=function(e,r,n,t){if(r)i?i(e,r,{value:n,enumerable:!t,configurable:!t,writable:!t}):e[r]=n;else{var a=function(r,n){p(e,r,(function(e){return this._invoke(r,n,e)}))};a("next",0),a("throw",1),a("return",2)}})(e,r,n,t)}function N(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,t)}return n}function d(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?N(Object(n),!0).forEach((function(r){h(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}function y(e,r,n,t,i,a,l){try{var u=e[a](l),o=u.value}catch(e){return void n(e)}u.done?r(o):Promise.resolve(o).then(t,i)}function v(e){return function(){var r=this,n=arguments;return new Promise((function(t,i){var a=e.apply(r,n);function l(e){y(a,t,i,l,u,"next",e)}function u(e){y(a,t,i,l,u,"throw",e)}l(void 0)}))}}function _(e,r,n,t){n&&Object.defineProperty(e,r,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(t):void 0})}function g(e,r){for(var n=0;n<r.length;n++){var t=r[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,w(t.key),t)}}function E(e,r,n){return r&&g(e.prototype,r),n&&g(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function h(e,r,n){return(r=w(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function w(e){var r=function(e,r){if("object"!=f(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var t=n.call(e,r||"default");if("object"!=f(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==f(r)?r:r+""}function O(e,r,n,t,i){var a={};return Object.keys(t).forEach((function(e){a[e]=t[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce((function(n,t){return t(e,r,n)||n}),a),i&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(i):void 0,a.initializer=void 0),void 0===a.initializer?(Object.defineProperty(e,r,a),null):a}var j=(i=O((t=E((function e(){!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e),_(this,"createEnv",i,this),_(this,"deleteEnv",a,this),_(this,"updateEnv",l,this),_(this,"findEnvList",u,this),_(this,"findEnvPage",o,this)}))).prototype,"createEnv",[m.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){var e=v(b().m((function e(r){var n,t;return b().w((function(e){for(;;)switch(e.n){case 0:return n=d({user:{id:Object(s.getUser)().userId}},r),e.n=1,s.Axios.post("/env/createEnv",n);case 1:return 0===(t=e.v).code?c.default.success("添加成功"):c.default.error("添加失败"),e.a(2,t)}}),e)})));return function(r){return e.apply(this,arguments)}}()}}),a=O(t.prototype,"deleteEnv",[m.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){var e=v(b().m((function e(r){var n,t;return b().w((function(e){for(;;)switch(e.n){case 0:return(n=new FormData).append("envId",r),e.n=1,s.Axios.post("/env/deleteEnv",n);case 1:return 0===(t=e.v).code?c.default.success("删除成功"):c.default.error("删除失败"),e.a(2,t)}}),e)})));return function(r){return e.apply(this,arguments)}}()}}),l=O(t.prototype,"updateEnv",[m.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){var e=v(b().m((function e(r){var n;return b().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,s.Axios.post("/env/updateEnv",r);case 1:return 0===(n=e.v).code?c.default.success("修改成功"):c.default.error("修改失败"),e.a(2,n)}}),e)})));return function(r){return e.apply(this,arguments)}}()}}),u=O(t.prototype,"findEnvList",[m.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return v(b().m((function e(){return b().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,s.Axios.post("/env/findEnvList",{});case 1:return e.a(2,e.v)}}),e)})))}}),o=O(t.prototype,"findEnvPage",[m.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){var e=v(b().m((function e(r){return b().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,s.Axios.post("/env/findEnvPage",r);case 1:return e.a(2,e.v)}}),e)})));return function(r){return e.apply(this,arguments)}}()}}),t);r.a=new j},937:function(e,r,n){"use strict";n(520);var t=n(519),i=(n(264),n(124)),a=(n(396),n(278)),l=n.n(a),u=(n(172),n(71)),o=(n(151),n(47)),c=(n(260),n(150)),m=(n(261),n(171)),s=(n(262),n(72)),f=n(0),b=n.n(f),p=n(349),N=n(350),d=n(184),y=n(44),v=n(9),_=n(154),g=n(152),E=n(174),h=n(596),w=n(270);function O(e){return(O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var j="/Users/gaomengyuan/tiklab/tiklab-arbess-ui/src/pipeline/pipeline/components/PipelineUserAdd.js";function S(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,t)}return n}function P(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?S(Object(n),!0).forEach((function(r){k(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}function k(e,r,n){return(r=function(e){var r=function(e,r){if("object"!=O(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var t=n.call(e,r||"default");if("object"!=O(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==O(r)?r:r+""}(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function I(e){return function(e){if(Array.isArray(e))return D(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||C(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var t,i,a,l,u=[],o=!0,c=!1;try{if(a=(n=n.call(e)).next,0===r){if(Object(n)!==n)return;o=!1}else for(;!(o=(t=a.call(n)).done)&&(u.push(t.value),u.length!==r);o=!0);}catch(e){c=!0,i=e}finally{try{if(!o&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(c)throw i}}return u}}(e,r)||C(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e,r){if(e){if("string"==typeof e)return D(e,r);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?D(e,r):void 0}}function D(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,t=Array(r);n<r;n++)t[n]=e[n];return t}var x=function(e){var r=e.setVisible,n=e.yUserList,i=e.setYUserList,a=e.pipelineStore.findUserPage,l=A(Object(f.useState)([]),2),u=l[0],o=l[1],c=A(Object(f.useState)([]),2),m=c[0],s=c[1],p=A(Object(f.useState)([]),2),N=p[0],d=p[1],y=A(Object(f.useState)({pageSize:5,currentPage:1}),1)[0],v=A(Object(f.useState)({pageParam:y}),2),_=v[0],O=v[1],S=A(Object(f.useState)({}),2),k=S[0],C=S[1];Object(f.useEffect)((function(){D()}),[_]);var D=function(){a(_).then((function(e){var r;0===e.code&&(s((null===(r=e.data)||void 0===r?void 0:r.dataList)||[]),C({currentPage:e.data.currentPage,totalPage:e.data.totalPage,totalRecord:e.data.totalRecord}))}))},x=function(e){return n&&n.some((function(r){return r.id===e.id}))},R=function(e){if(!x(e)){var r=e.id,n=I(N),t=I(u),i=n.indexOf(r);if(i>=0){n.splice(i,1);var a=t.findIndex((function(e){return e.id===r}));a>=0&&t.splice(a,1)}else n.push(r),t.push(P(P({},e),{},{roleType:0}));d(n),o(t)}},T={onSelectAll:function(e,r,n){var t,i,a=n.map((function(e){return e&&e.id})).filter(Boolean),l=n.map((function(e){return P(P({},e),{},{roleType:0})})).filter(Boolean);e?(t=Array.from(new Set([].concat(I(N),I(a)))),i=Array.from(new Set([].concat(I(u),I(l))))):(t=N.filter((function(e){return!a.includes(e)})),i=u.filter((function(e){return!a.includes(e.id)}))),d(t),o(i)},onSelect:function(e){R(e)},getCheckboxProps:function(e){return{disabled:x(e)}},selectedRowKeys:N};return b.a.createElement("div",{className:"pipeline-user-add",__source:{fileName:j,lineNumber:168,columnNumber:9}},b.a.createElement(w.a,{placeholder:"搜索姓名",onPressEnter:function(e){O({pageParam:y,nickname:e.target.value})},__source:{fileName:j,lineNumber:169,columnNumber:13}}),b.a.createElement("div",{className:"pipeline-user-add-table",__source:{fileName:j,lineNumber:173,columnNumber:13}},b.a.createElement(t.default,{rowKey:function(e){return e.id},rowSelection:T,onRow:function(e){return{onClick:function(){return R(e)}}},columns:[{title:"姓名",dataIndex:"nickname",key:"nickname",width:"100%",ellipsis:!0}],dataSource:m,pagination:!1,locale:{emptyText:b.a.createElement(E.a,{__source:{fileName:j,lineNumber:189,columnNumber:41}})},__source:{fileName:j,lineNumber:174,columnNumber:17}}),b.a.createElement(h.a,{currentPage:_.pageParam.currentPage,changPage:function(e){O(P(P({},_),{},{pageParam:{pageSize:5,currentPage:e}}))},page:k,__source:{fileName:j,lineNumber:192,columnNumber:17}})),b.a.createElement("div",{className:"pipeline-user-add-btn",__source:{fileName:j,lineNumber:198,columnNumber:13}},b.a.createElement(g.a,{onClick:function(){return r(!1)},title:"取消",isMar:!0,__source:{fileName:j,lineNumber:199,columnNumber:17}}),b.a.createElement(g.a,{onClick:function(){var e=Array.from(new Set([].concat(I(n),I(u))));i(e),r(!1)},title:"确定",type:"primary",__source:{fileName:j,lineNumber:200,columnNumber:17}})))},R=n(755),T=n(861),U=n(177);function z(e){return(z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var L="/Users/gaomengyuan/tiklab/tiklab-arbess-ui/src/pipeline/pipeline/components/PipelineAddInfo.js";function F(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,t)}return n}function V(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?F(Object(n),!0).forEach((function(r){G(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):F(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}function G(e,r,n){return(r=function(e){var r=function(e,r){if("object"!=z(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var t=n.call(e,r||"default");if("object"!=z(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==z(r)?r:r+""}(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function M(e){return function(e){if(Array.isArray(e))return K(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||$(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function B(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var t,i,a,l,u=[],o=!0,c=!1;try{if(a=(n=n.call(e)).next,0===r){if(Object(n)!==n)return;o=!1}else for(;!(o=(t=a.call(n)).done)&&(u.push(t.value),u.length!==r);o=!0);}catch(e){c=!0,i=e}finally{try{if(!o&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(c)throw i}}return u}}(e,r)||$(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $(e,r){if(e){if("string"==typeof e)return K(e,r);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?K(e,r):void 0}}function K(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,t=Array(r);n<r;n++)t[n]=e[n];return t}var H=Object(f.forwardRef)((function(e,r){var n=e.set,a=e.setCurrent,y=e.baseInfo,h=e.setBaseInfo,w=e.onClick,O=e.pipeline,j=e.setPipeline,S=e.changFresh,P=U.a.findUserPipeline,k=U.a.updatePipeline,I=U.a.pipelineList,A=R.a.findEnvList,C=T.a.findGroupList,D=B(s.default.useForm(),1)[0],z=Object(v.getUser)(),F=B(Object(f.useState)(!1),2),G=F[0],$=F[1],K=B(Object(f.useState)((null==y?void 0:y.type)||1),2),H=(K[0],K[1],B(Object(f.useState)(1),2)),J=H[0],Y=H[1],q=B(Object(f.useState)((null==y?void 0:y.userList)||[]),2),Z=q[0],Q=q[1],W=B(Object(f.useState)([]),2),X=W[0],ee=W[1],re=B(Object(f.useState)([]),2),ne=re[0],te=re[1];Object(f.useEffect)((function(){ie(),n||(Y((null==y?void 0:y.power)||1),P().then())}),[]),Object(f.useEffect)((function(){O&&(D.setFieldsValue(O),Y(null==O?void 0:O.power))}),[O]);var ie=function(){A().then((function(e){0===e.code&&ee(e.data||[])})),C().then((function(e){0===e.code&&te(e.data||[])}))},ae=function(){D.validateFields().then((function(r){if(n){var t=V(V({},r),{},{id:O.id,name:""===r.name?O.name:r.name,power:J});k(t).then((function(r){0===r.code&&("function"==typeof S?(w(),S()):(j(V(V({},O),t)),e.history.push("/pipeline/".concat(O.id,"/overview"))))}))}else a(1),h(V(V({},r),{},{type:2,power:J,userList:Z}))}))},le=function(){D.resetFields()};Object(f.useImperativeHandle)(r,(function(){return{onOk:ae,onRest:le}}));var ue=[{id:1,title:"全局",icon:b.a.createElement(p.a,{__source:{fileName:L,lineNumber:157,columnNumber:18}}),desc:"公共项目，全部成员可见。不支持TFVC等某些功能。"},{id:2,title:"私有",icon:b.a.createElement(N.a,{__source:{fileName:L,lineNumber:163,columnNumber:18}}),desc:"只有您授予访问权限的人才能查看此项目。"}],oe=b.a.createElement(s.default.Item,{className:"pipeline-power",label:"流水线权限",__source:{fileName:L,lineNumber:170,columnNumber:9}},b.a.createElement("div",{className:"pipeline-power-content",__source:{fileName:L,lineNumber:171,columnNumber:13}},ue.map((function(e){return b.a.createElement("div",{key:e.id,className:"pipeline-power-item ".concat(n?"pipeline-power-set":"pipeline-power-noSet"," ").concat(J===e.id?"pipeline-power-select":""),onClick:function(){return Y(e.id)},__source:{fileName:L,lineNumber:174,columnNumber:32}},b.a.createElement("div",{className:"power-item",__source:{fileName:L,lineNumber:179,columnNumber:29}},b.a.createElement("div",{__source:{fileName:L,lineNumber:180,columnNumber:33}},b.a.createElement("div",{className:"power-title power-icon",__source:{fileName:L,lineNumber:181,columnNumber:37}},e.icon),b.a.createElement("div",{className:"power-title power-name",__source:{fileName:L,lineNumber:182,columnNumber:37}},e.title))),b.a.createElement("div",{className:"power-desc",__source:{fileName:L,lineNumber:185,columnNumber:29}},e.desc))})))),ce=[{title:"姓名",dataIndex:"nickname",key:"nickname",width:"35%",ellipsis:!0,render:function(e){return e||"--"}},{title:"名称",dataIndex:"name",key:"name",width:"30%",ellipsis:!0,render:function(e,r){return b.a.createElement(m.default,{__source:{fileName:L,lineNumber:210,columnNumber:21}},b.a.createElement(_.a,{userInfo:r,__source:{fileName:L,lineNumber:211,columnNumber:25}}),e||"--")}},{title:"权限",dataIndex:"roleType",key:"roleType",width:"28",ellipsis:!0,render:function(e,r){return b.a.createElement(c.default,{bordered:!1,showarrow:"false",style:{width:120},defaultValue:r.roleType,disabled:r.id===z.userId,onChange:function(e){return function(e,r){Z&&Z.map((function(n){n.id===e.id&&(n.roleType=r)})),Q(M(Z))}(r,e)},__source:{fileName:L,lineNumber:224,columnNumber:17}},r.id===z.userId&&b.a.createElement(c.default.Option,{value:2,__source:{fileName:L,lineNumber:234,columnNumber:25}},"超级管理员"),b.a.createElement(c.default.Option,{value:1,__source:{fileName:L,lineNumber:236,columnNumber:21}},"管理员角色"),b.a.createElement(c.default.Option,{value:0,__source:{fileName:L,lineNumber:237,columnNumber:21}},"默认角色"))}},{title:"操作",dataIndex:"action",key:"action",width:"7%",ellipsis:!0,render:function(e,r){return r.id!==z.userId?b.a.createElement(o.default,{title:"移出用户",__source:{fileName:L,lineNumber:250,columnNumber:25}},b.a.createElement(d.default,{onClick:function(){return function(e){Q(Z.filter((function(r){return r.id!==e.id})))}(r)},__source:{fileName:L,lineNumber:251,columnNumber:29}})):b.a.createElement("span",{className:"user-table-ban",__source:{fileName:L,lineNumber:256,columnNumber:21}},b.a.createElement(d.default,{__source:{fileName:L,lineNumber:257,columnNumber:26}}))}}],me=[{required:!n,message:"名称不能为空"},{pattern:/^[\u4e00-\u9fa5a-zA-Z0-9_-]{0,50}$/,message:"流水线名称最长50位且不能包含非法字符，如&,%，&，#……等"},function(e){e.getFieldValue;return{validator:function(e,r){return(n?I&&I.map((function(e){return e.name})).filter((function(e){return e!==O.name})):I&&I.map((function(e){return e.name}))).includes(r)?Promise.reject("名称已经存在"):Promise.resolve()}}}],se=B(Object(f.useState)(0),2),fe=se[0],be=se[1];return Object(f.useEffect)((function(){var e;n&&be((null==O||null===(e=O.name)||void 0===e?void 0:e.length)||0)}),[O]),n?b.a.createElement(b.a.Fragment,null,b.a.createElement(s.default,{form:D,autoComplete:"off",layout:"vertical",initialValues:O,__source:{fileName:L,lineNumber:301,columnNumber:17}},b.a.createElement(s.default.Item,{label:"流水线名称",name:"name",rules:me,__source:{fileName:L,lineNumber:307,columnNumber:21}},b.a.createElement(u.default,{allowClear:!0,placeholder:"流水线名称",maxLength:50,suffix:b.a.createElement("span",{style:{color:"#999"},__source:{fileName:L,lineNumber:312,columnNumber:37}},fe,"/50"),onChange:function(e){return be(e.target.value.length)},__source:{fileName:L,lineNumber:308,columnNumber:25}})),b.a.createElement(s.default.Item,{label:"流水线应用",name:["group","id"],__source:{fileName:L,lineNumber:316,columnNumber:21}},b.a.createElement(c.default,{placeholder:"流水线应用",__source:{fileName:L,lineNumber:317,columnNumber:25}},ne&&ne.map((function(e){return b.a.createElement(c.default.Option,{value:e.id,key:e.id,__source:{fileName:L,lineNumber:320,columnNumber:37}},e.groupName)})))),b.a.createElement(s.default.Item,{label:"流水线环境",name:["env","id"],__source:{fileName:L,lineNumber:325,columnNumber:21}},b.a.createElement(c.default,{placeholder:"流水线环境",__source:{fileName:L,lineNumber:326,columnNumber:25}},X&&X.map((function(e){return b.a.createElement(c.default.Option,{value:e.id,key:e.id,__source:{fileName:L,lineNumber:329,columnNumber:37}},e.envName)})))),oe),"function"==typeof S?null:b.a.createElement(b.a.Fragment,null,b.a.createElement(g.a,{onClick:w,title:"取消",isMar:!0,__source:{fileName:L,lineNumber:339,columnNumber:29}}),b.a.createElement(l.a,{code:"pipeline_update",domainId:O&&O.id,__source:{fileName:L,lineNumber:340,columnNumber:29}},b.a.createElement(g.a,{type:"primary",title:"确定",onClick:ae,__source:{fileName:L,lineNumber:341,columnNumber:33}})))):b.a.createElement(s.default,{form:D,autoComplete:"off",layout:"vertical",initialValues:y,__source:{fileName:L,lineNumber:350,columnNumber:9}},b.a.createElement(s.default.Item,{label:"流水线名称",name:"name",rules:me,__source:{fileName:L,lineNumber:356,columnNumber:13}},b.a.createElement(u.default,{allowClear:!0,placeholder:"流水线名称",maxLength:50,suffix:b.a.createElement("span",{style:{color:"#999"},__source:{fileName:L,lineNumber:365,columnNumber:29}},fe,"/50"),onChange:function(e){return be(e.target.value.length)},__source:{fileName:L,lineNumber:361,columnNumber:17}})),b.a.createElement(s.default.Item,{label:"流水线应用",name:["group","id"],__source:{fileName:L,lineNumber:369,columnNumber:13}},b.a.createElement(c.default,{placeholder:"流水线应用",__source:{fileName:L,lineNumber:370,columnNumber:17}},ne&&ne.map((function(e){return b.a.createElement(c.default.Option,{value:e.id,key:e.id,__source:{fileName:L,lineNumber:373,columnNumber:29}},e.groupName)})))),b.a.createElement(s.default.Item,{label:"流水线环境",name:["env","id"],__source:{fileName:L,lineNumber:378,columnNumber:13}},b.a.createElement(c.default,{placeholder:"流水线环境",__source:{fileName:L,lineNumber:379,columnNumber:17}},X&&X.map((function(e){return b.a.createElement(c.default.Option,{value:e.id,key:e.id,__source:{fileName:L,lineNumber:382,columnNumber:29}},e.envName)})))),oe,2===J&&b.a.createElement(s.default.Item,{className:"pipeline-user",__source:{fileName:L,lineNumber:390,columnNumber:17}},b.a.createElement("div",{className:"pipeline-user-title ant-form-item-label",__source:{fileName:L,lineNumber:391,columnNumber:21}},b.a.createElement("label",{__source:{fileName:L,lineNumber:392,columnNumber:25}},"通知对象"),b.a.createElement(i.default,{getPopupContainer:function(e){return e.parentElement},overlay:b.a.createElement(x,{setVisible:$,yUserList:Z,setYUserList:Q,pipelineStore:U.a,__source:{fileName:L,lineNumber:396,columnNumber:33}}),visible:G,onVisibleChange:function(e){return $(e)},trigger:["click"],placement:"bottomRight",overlayStyle:{width:240},__source:{fileName:L,lineNumber:393,columnNumber:25}},b.a.createElement(g.a,{type:"link-nopadding",title:"添加成员",__source:{fileName:L,lineNumber:409,columnNumber:29}}))),b.a.createElement("div",{className:"pipeline-user-table",__source:{fileName:L,lineNumber:415,columnNumber:21}},b.a.createElement(t.default,{rowKey:function(e){return e.id},columns:ce,dataSource:Z,pagination:!1,showHeader:!1,locale:{emptyText:b.a.createElement(E.a,{__source:{fileName:L,lineNumber:422,columnNumber:49}})},__source:{fileName:L,lineNumber:416,columnNumber:25}}))))}));r.a=Object(y.observer)(H)},989:function(e,r,n){"use strict";n(173);var t=n(97),i=(n(172),n(71)),a=n(0),l=n.n(a),u=n(268),o=n(177),c=n(579),m="/Users/gaomengyuan/tiklab/tiklab-arbess-ui/src/pipeline/pipeline/components/PipelineDelete.js";function s(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var t,i,a,l,u=[],o=!0,c=!1;try{if(a=(n=n.call(e)).next,0===r){if(Object(n)!==n)return;o=!1}else for(;!(o=(t=a.call(n)).done)&&(u.push(t.value),u.length!==r);o=!0);}catch(e){c=!0,i=e}finally{try{if(!o&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(c)throw i}}return u}}(e,r)||function(e,r){if(e){if("string"==typeof e)return f(e,r);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,r):void 0}}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,t=Array(r);n<r;n++)t[n]=e[n];return t}r.a=function(e){var r=e.delVisible,n=e.setDelVisible,f=e.pipeline,b=e.changPage,p=e.page,N=o.a.deletePipeline,d=s(Object(a.useState)(""),2),y=d[0],v=d[1],_=s(Object(a.useState)(null),2),g=_[0],E=_[1],h=s(Object(a.useState)(!1),2),w=h[0],O=h[1],j=function(){w||(O(!1),n(!1),v(""),E(null))};return l.a.createElement(u.a,{visible:r,onCancel:j,onOk:function(){w||(""!==y.trim()&&y===f.name?(O(!0),N(f.id).then((function(){if(j(),"function"==typeof b){var r=Object(c.d)(p.totalRecord,15,p.currentPage);b(r)}else e.history.push("/pipeline")}))):E("流水线名称错误"))},title:"删除流水线",okText:"确认删除",okType:"dangerous",__source:{fileName:m,lineNumber:64,columnNumber:9}},l.a.createElement(t.a,{spinning:w,tip:"删除中...",__source:{fileName:m,lineNumber:72,columnNumber:13}},l.a.createElement("div",{className:"pipelineReDel-modal",__source:{fileName:m,lineNumber:73,columnNumber:17}},l.a.createElement("div",{className:"pipelineReDel-modal-warn",__source:{fileName:m,lineNumber:74,columnNumber:21}},"危险：流水线删除无法恢复！请慎重操作！"),l.a.createElement("div",{className:"pipelineReDel-modal-warn",__source:{fileName:m,lineNumber:75,columnNumber:21}},l.a.createElement("div",{__source:{fileName:m,lineNumber:76,columnNumber:25}},"该操作将永久删除流水线",l.a.createElement("span",{className:"warn-pipeline",__source:{fileName:m,lineNumber:76,columnNumber:41}}," ",null==f?void 0:f.name," "),"的相关数据，包括（配置、历史、制品）等。"),l.a.createElement("div",{className:"warn-continue",__source:{fileName:m,lineNumber:77,columnNumber:25}},"为防止意外，确认继续操作请输入以下内容："),l.a.createElement("div",{className:"warn-pipeline-title",__source:{fileName:m,lineNumber:78,columnNumber:25}},null==f?void 0:f.name)),l.a.createElement("div",{className:"pipelineReDel-modal-input",__source:{fileName:m,lineNumber:80,columnNumber:21}},l.a.createElement(i.default,{className:"".concat(g?"inputs-error":""),placeholder:"请输入提示内容以确认继续操作",onChange:function(e){return v(e.target.value)},__source:{fileName:m,lineNumber:81,columnNumber:25}})),l.a.createElement("div",{className:"pipelineReDel-modal-error",__source:{fileName:m,lineNumber:87,columnNumber:21}},g))))}}}]);